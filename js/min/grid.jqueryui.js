(function(b){"function"===typeof define&&define.amd?define("jquery ./grid.base jquery-ui/dialog jquery-ui/draggable jquery-ui/droppable jquery-ui/resizable jquery-ui/sortable".split(" "),b):"object"===typeof exports?b(require("jquery")):b(jQuery)})(function(b){var u=b.jgrid,x=u.jqID,r=null!=b.ui?b.ui.multiselect:null,A=function(a){if(null!=this.grid&&null!=this.grid.p){var h=this,f=this.grid.p,d,c,g,m,k=this.gh,e=this.selectedList,p=e.find("li"),q,l=Array(f.colModel.length),t=p.length-1,v=function(a,
c,f){var g,d=e.find("li");for(void 0===c&&(c=f?d.length-1:0);f?0<=c:c<d.length;f?c--:c++)if((g=b(d[c]).data("optionLink"))&&a.call(d[c],parseInt(g.val(),10),c))return c};q=function(c){if(l[c]===l[a])return b(this).after(p[t]),n(),!0};var r=function(c){if(l[c]===l[a])return b(this).before(p[t]),n(),!0},u=function(b){if(l[b]===l[a]&&void 0!==l[b])return k[l[b]].startColumnName=f.colModel[b].name,!0},n=function(){c=b.inArray(f.colModel[a].name,h.newColOrder);0<=c&&h.newColOrder.splice(c,1);p=e.find("li");
d=0;v(function(c,e){if(c===a){for(t=e;0<=d&&!f.colModel[d].hidden&&f.colModel[d].hidedlg&&l[d]===l[a];)d++;h.newColOrder.splice(d,0,f.colModel[a].name);return!0}d=b.inArray(f.colModel[c].name,h.newColOrder,d);0>d&&(d=b.inArray(f.colModel[c].name,h.newColOrder));d++})};if(k)for(g=0;g<k.length;g++)for(m=k[g],d=0;d<m.numberOfColumns;d++)l[f.iColByName[m.startColumnName]+d]=g;n();if(k&&void 0!==k[l[a]])for(m=k[l[a]],c=0;c<m.numberOfColumns;c++){if(d=f.iColByName[m.startColumnName]+c,!f.colModel[d].hidden&&
!f.colModel[d].hidedlg){v(q,t-1,!0);v(r,t+1);v(u);break}}else!k||(p=e.find("li"),c=v(function(b){if(b===a)return!0}),c+1>=p.length||0>c||!(q=b(p[c+1]).data("optionLink")))||(g=l[parseInt(q.val(),10)],void 0!==g&&(q=b(p[c-1]).data("optionLink"))&&l[parseInt(q.val(),10)]===g&&(q=v(function(b){if(l[b]!==g)return!0},c+1),b(p[q>=p.length?p.length-1:q-1]).after(p[t]),n()))}};u.msie&&8===u.msiever()&&(b.expr[":"].hidden=function(b){return 0===b.offsetWidth||0===b.offsetHeight||"none"===b.style.display});
u._multiselect=!1;if(r){if(r.prototype._setSelected){var B=r.prototype._setSelected;r.prototype._setSelected=function(a,h){var f=B.call(this,a,h),d=this.element,c=parseInt(a.data("optionLink").val(),10);h&&this.selectedList&&(A.call(this,c),this.selectedList.find("li").each(function(){b(this).data("optionLink")&&b(this).data("optionLink").remove().appendTo(d)}));return f}}r.prototype.destroy&&(r.prototype.destroy=function(){this.element.show();this.container.remove();void 0===b.Widget?b.widget.prototype.destroy.apply(this,
arguments):b.Widget.prototype.destroy.apply(this,arguments)});u._multiselect=!0}u.extend({sortableColumns:function(a){return this.each(function(){function h(){d.disableClick=!0}var f=this,d=f.p,c=x(d.id),c={tolerance:"pointer",axis:"x",scrollSensitivity:"1",items:">th:not(:has(#jqgh_"+c+"_cb,#jqgh_"+c+"_rn,#jqgh_"+c+"_subgrid),:hidden)",placeholder:{element:function(a){return b(document.createElement(a[0].nodeName)).addClass(a[0].className+" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0]},
update:function(b,a){a.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10));a.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10))}},update:function(a,c){var e=b(">th",b(c.item).parent()),g=d.id+"_",h=[];e.each(function(){var a=b(">div",this).get(0).id.replace(/^jqgh_/,"").replace(g,""),a=d.iColByName[a];void 0!==a&&h.push(a)});b(f).jqGrid("remapColumns",
h,!0,!0);b.isFunction(d.sortable.update)&&d.sortable.update(h);setTimeout(function(){d.disableClick=!1},50)}};d.sortable.options?b.extend(c,d.sortable.options):b.isFunction(d.sortable)&&(d.sortable={update:d.sortable});if(c.start){var g=c.start;c.start=function(b,a){h();g.call(this,b,a)}}else c.start=h;d.sortable.exclude&&(c.items+=":not("+d.sortable.exclude+")");c=a.sortable(c);c=c.data("sortable")||c.data("uiSortable")||c.data("ui-sortable");null!=c&&(c.floating=!0)})},columnChooser:function(a){function h(a,
c){a&&("string"===typeof a?b.fn[a]&&b.fn[a].apply(c,b.makeArray(arguments).slice(2)):b.isFunction(a)&&a.apply(c,b.makeArray(arguments).slice(2)))}var f=this,d=f[0],c=d.p,g,m,k,e,p=c.colModel;k=p.length;var q=c.colNames,l=function(b){return r&&r.prototype&&b.data(r.prototype.widgetFullName||r.prototype.widgetName)||b.data("ui-multiselect")||b.data("multiselect")};if(!b("#colchooser_"+x(c.id)).length){g=b('<div id="colchooser_'+c.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>');
m=b("select",g);a=b.extend({width:400,height:240,classname:null,done:function(b){b&&f.jqGrid("remapColumns",b,!0)},msel:"multiselect",dlog:"dialog",dialog_opts:{minWidth:470,dialogClass:"ui-jqdialog"},dlog_opts:function(a){var c={};c[a.bSubmit]=function(){a.apply_perm();a.cleanup(!1)};c[a.bCancel]=function(){a.cleanup(!0)};return b.extend(!0,{buttons:c,close:function(){a.cleanup(!0)},modal:a.modal||!1,resizable:a.resizable||!0,width:a.width+70,resize:function(){var b=l(m),a=b.container.closest(".ui-dialog-content");
0<a.length&&"object"===typeof a[0].style?a[0].style.width="":a.css("width","");b.selectedList.height(Math.max(b.selectedContainer.height()-b.selectedActions.outerHeight()-1,1));b.availableList.height(Math.max(b.availableContainer.height()-b.availableActions.outerHeight()-1,1))}},a.dialog_opts||{})},apply_perm:function(){var g=Array(c.colModel.length),d,k={notSkipFrozen:void 0===a.notSkipFrozen?!1:a.notSkipFrozen,skipSetGridWidth:!0,skipSetGroupHeaders:!0};for(d=0;d<c.colModel.length;d++)g[d]=c.iColByName[e.newColOrder[d]];
b("option",m).each(function(){b(this).is(":selected")?f.jqGrid("showCol",p[this.value].name,k):f.jqGrid("hideCol",p[this.value].name,k)});a.done&&a.done.call(f,g);if(c.groupHeader&&("object"===typeof c.groupHeader||b.isFunction(c.groupHeader)))if(f.jqGrid("destroyGroupHeader",!1),c.groupHeader.groupHeaders=e.gh,null!=c.pivotOptions&&null!=c.pivotOptions.colHeaders&&1<c.pivotOptions.colHeaders.length)for(g=c.pivotOptions.colHeaders,d=0;d<g.length;d++)g[d]&&g[d].groupHeaders.length&&f.jqGrid("setGroupHeaders",
g[d]);else f.jqGrid("setGroupHeaders",c.groupHeader);f.jqGrid("setGridWidth",c.autowidth||void 0!==c.widthOrg&&"auto"!==c.widthOrg&&"100%"!==c.widthOrg?c.width:c.tblwidth,c.shrinkToFit)},cleanup:function(b){h(a.dlog,g,"destroy");h(a.msel,m,"destroy");g.remove();b&&a.done&&a.done.call(f)},msel_opts:{}},f.jqGrid("getGridRes","col"),u.col,a||{});if(b.ui&&r&&r.defaults){if(!u._multiselect){(null!=u.defaults&&b.isFunction(u.defaults.fatalError)?u.defaults.fatalError:alert)("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");
return}a.msel_opts=b.extend(r.defaults,a.msel_opts)}a.caption&&g.attr("title",a.caption);a.classname&&(g.addClass(a.classname),m.addClass(a.classname));a.width&&(b(">div",g).css({width:a.width,margin:"0 auto"}),m.css("width",a.width));a.height&&(b(">div",g).css("height",a.height),m.css("height",a.height-10));m.empty();var t=null!=c.groupHeader?c.groupHeader.groupHeaders:0,v={},w,z,n,y;if(t)for(w=0;w<t.length;w++)for(y=t[w],z=0;z<y.numberOfColumns;z++)n=c.iColByName[y.startColumnName]+z,v[n]=b.isFunction(a.buildItemText)?
a.buildItemText.call(f[0],{iCol:n,cm:p[n],cmName:p[n].name,colName:q[n],groupTitleText:y.titleText}):b.jgrid.stripHtml(y.titleText)+": "+b.jgrid.stripHtml(""===q[n]?p[n].name:q[n]);for(n=0;n<k;n++)void 0===v[n]&&(v[n]=b.isFunction(a.buildItemText)?a.buildItemText.call(f[0],{iCol:n,cm:p[n],cmName:p[n].name,colName:q[n],groupTitleText:null}):b.jgrid.stripHtml(q[n]));b.each(p,function(b){this.hidedlg||m.append("<option value='"+b+"'"+(c.headertitles||this.headerTitle?" title='"+u.stripHtml("string"===
typeof this.headerTitle?this.headerTitle:v[b])+"'":"")+(this.hidden?"":" selected='selected'")+">"+v[b]+"</option>")});k=b.isFunction(a.dlog_opts)?a.dlog_opts.call(f,a):a.dlog_opts;h(a.dlog,g,k);k=b.isFunction(a.msel_opts)?a.msel_opts.call(f,a):a.msel_opts;h(a.msel,m,k);k=b("#colchooser_"+x(c.id));k.css({margin:"auto"});k.find(">div").css({width:"100%",height:"100%",margin:"auto"});if(e=l(m))e.grid=d,null!=c.groupHeader&&(e.gh=b.extend(!0,[],c.groupHeader.groupHeaders)),e.newColOrder=b.map(p,function(b){return b.name}),
e.container.css({width:"100%",height:"100%",margin:"auto"}),e.selectedContainer.css({width:100*e.options.dividerLocation+"%",height:"100%",margin:"auto",boxSizing:"border-box"}),e.availableContainer.css({width:100-100*e.options.dividerLocation+"%",height:"100%",margin:"auto",boxSizing:"border-box"}),e.selectedList.css("height","auto"),e.availableList.css("height","auto"),k=Math.max(e.selectedList.height(),e.availableList.height()),k=Math.min(k,b(window).height()),e.selectedList.css("height",k),e.availableList.css("height",
k),null!=e.options&&e.options.sortable&&e.selectedList.bind("sortupdate",function(c,g){t&&A.call(e,parseInt(g.item.data("optionLink").val(),10));g.item.css({width:"",height:""});b.isFunction(a.sortUpdate)&&a.sortUpdate.call(d,c,g)}),b.isFunction(a.init)&&a.init.call(d,e)}},sortableRows:function(a){return this.each(function(){var h=this,f=h.grid,d=h.p;f&&!d.treeGrid&&b.fn.sortable&&(a=b.extend({cursor:"move",axis:"y",items:">tbody>.jqgrow"},a||{}),a.start&&b.isFunction(a.start)?(a._start_=a.start,
delete a.start):a._start_=!1,a.update&&b.isFunction(a.update)?(a._update_=a.update,delete a.update):a._update_=!1,a.start=function(c,g){b(g.item).css("border-width","0");b("td",g.item).each(function(b){this.style.width=f.cols[b].style.width});if(d.subGrid){var m=b(g.item).attr("id");try{b(h).jqGrid("collapseSubGridRow",m)}catch(k){}}a._start_&&a._start_.apply(this,[c,g])},a.update=function(c,g){b(g.item).css("border-width","");!0===d.rownumbers&&b("td.jqgrid-rownum",h.rows).each(function(a){b(this).html(a+
1+(parseInt(d.page,10)-1)*parseInt(d.rowNum,10))});a._update_&&a._update_.apply(this,[c,g])},b(h).sortable(a),b.isFunction(b.fn.disableSelection)&&b(h.tBodies[0]).children("tr.jqgrow").disableSelection())})},gridDnD:function(a){return this.each(function(){function h(){var a=b.data(f,"dnd");b("tr.jqgrow:not(.ui-draggable)",f).draggable(b.isFunction(a.drag)?a.drag.call(b(f),a):a.drag)}var f=this,d,c;if(f.grid&&!f.p.treeGrid&&b.fn.draggable&&b.fn.droppable)if(void 0===b("#jqgrid_dnd")[0]&&b("body").append("<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>"),
"string"===typeof a&&"updateDnD"===a&&!0===f.p.jqgdnd)h();else if(a=b.extend({drag:function(a){return b.extend({start:function(c,d){var e;if(f.p.subGrid){e=b(d.helper).attr("id");try{b(f).jqGrid("collapseSubGridRow",e)}catch(h){}}for(e=0;e<b.data(f,"dnd").connectWith.length;e++)0===b(b.data(f,"dnd").connectWith[e]).jqGrid("getGridParam","reccount")&&b(b.data(f,"dnd").connectWith[e]).jqGrid("addRowData","jqg_empty_row",{});d.helper.addClass("ui-state-highlight");b("td",d.helper).each(function(b){this.style.width=
f.grid.headers[b].width+"px"});a.onstart&&b.isFunction(a.onstart)&&a.onstart.call(b(f),c,d)},stop:function(c,d){var e;d.helper.dropped&&!a.dragcopy&&(e=b(d.helper).attr("id"),void 0===e&&(e=b(this).attr("id")),b(f).jqGrid("delRowData",e));for(e=0;e<b.data(f,"dnd").connectWith.length;e++)b(b.data(f,"dnd").connectWith[e]).jqGrid("delRowData","jqg_empty_row");a.onstop&&b.isFunction(a.onstop)&&a.onstop.call(b(f),c,d)}},a.drag_opts||{})},drop:function(a){return b.extend({accept:function(a){if(!b(a).hasClass("jqgrow"))return a;
a=b(a).closest("table.ui-jqgrid-btable");return 0<a.length&&void 0!==b.data(a[0],"dnd")?(a=b.data(a[0],"dnd").connectWith,-1!==b.inArray("#"+x(this.id),a)?!0:!1):!1},drop:function(c,d){if(b(d.draggable).hasClass("jqgrow")){var e=b(d.draggable).attr("id"),e=d.draggable.parent().parent().jqGrid("getRowData",e);if(!a.dropbyname){var h=0,q={},l,t,r=b("#"+x(this.id)).jqGrid("getGridParam","colModel");try{for(t in e)e.hasOwnProperty(t)&&(l=r[h].name,"cb"!==l&&"rn"!==l&&"subgrid"!==l&&e.hasOwnProperty(t)&&
r[h]&&(q[l]=e[t]),h++);e=q}catch(u){}}d.helper.dropped=!0;a.beforedrop&&b.isFunction(a.beforedrop)&&(l=a.beforedrop.call(this,c,d,e,b("#"+x(f.p.id)),b(this)),void 0!==l&&null!==l&&"object"===typeof l&&(e=l));if(d.helper.dropped){var w;a.autoid&&(b.isFunction(a.autoid)?w=a.autoid.call(this,e):(w=Math.ceil(1E3*Math.random()),w=a.autoidprefix+w));b("#"+x(this.id)).jqGrid("addRowData",w,e,a.droppos);e[f.p.localReader.id]=w}a.ondrop&&b.isFunction(a.ondrop)&&a.ondrop.call(this,c,d,e)}}},a.drop_opts||{})},
onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{},drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5E3},dragcopy:!1,dropbyname:!1,droppos:"first",autoid:!0,autoidprefix:"dnd_"},a||{}),a.connectWith)for(a.connectWith=a.connectWith.split(","),a.connectWith=b.map(a.connectWith,function(a){return b.trim(a)}),b.data(f,"dnd",a),0===f.p.reccount||f.p.jqgdnd||h(),f.p.jqgdnd=!0,d=0;d<a.connectWith.length;d++)c=a.connectWith[d],b(c).droppable(b.isFunction(a.drop)?
a.drop.call(b(f),a):a.drop)})},gridResize:function(a){return this.each(function(){var h=this,f=h.grid,d=h.p,c=d.gView+">.ui-jqgrid-bdiv",g=!1,m,k=d.height;if(f&&b.fn.resizable){a=b.extend({},a||{});a.alsoResize?(a._alsoResize_=a.alsoResize,delete a.alsoResize):a._alsoResize_=!1;a.stop&&b.isFunction(a.stop)?(a._stop_=a.stop,delete a.stop):a._stop_=!1;a.stop=function(e,q){b(h).jqGrid("setGridWidth",q.size.width,a.shrinkToFit);b(d.gView+">.ui-jqgrid-titlebar").css("width","");g?(b(m).each(function(){b(this).css("height",
"")}),"auto"!==k&&"100%"!==k||b(f.bDiv).css("height",k)):b(h).jqGrid("setGridParam",{height:b(c).height()});h.fixScrollOffsetAndhBoxPadding&&h.fixScrollOffsetAndhBoxPadding();a._stop_&&a._stop_.call(h,e,q)};m=c;"auto"!==k&&"100%"!==k||void 0!==a.handles||(a.handles="e,w");if(a.handles){var e=b.map(String(a.handles).split(","),function(a){return b.trim(a)});2===e.length&&("e"===e[0]&&"w"===e[1]||"e"===e[1]&&"w"===e[1])&&(m=d.gView+">div:not(.frozen-div)",g=!0,d.pager&&(m+=","+d.pager))}a.alsoResize=
a._alsoResize_?m+","+a._alsoResize_:m;delete a._alsoResize_;b(d.gBox).resizable(a)}})}})});
//# sourceMappingURL=grid.jqueryui.map
