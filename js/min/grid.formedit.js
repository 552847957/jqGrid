(function(a){"function"===typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.common","./jsonxml"],a):"object"===typeof exports?a(require("jquery")):a(jQuery)})(function(a){var u=a.jgrid,D=u.jqID,G=a.fn.jqGrid,S=u.mergeCssClasses,T=u.hasOneFromClasses,Y=function(a,P){return S(u.getRes(u.guiStyles[this.p.guiStyle],a),P||"")},Q=function(a){return Y.call(this,"states."+a)},ma=u.feedback,oa=u.fullBoolFeedback,M=u.hideModal,fa=u.viewModal,ga=u.createModal,na=u.info_dialog,
R=u.builderFmButon,U=function(a,u){var h=a[0].style[u];return 0<=h.indexOf("px")?parseFloat(h):h},pa=function(k,u,h){var m=h.w;u=a(u);var l=this.closest(".ui-jqgrid"),c;a.contains(l[0],m[0])?(c=U(m,"top"),l=U(m,"left")):(c=m.offset().top-(l.offsetParent().offset().top+l.offset().top+l.position().top+parseFloat(l.css("border-top-width")||0)),l=m.offset().left-(l.offsetParent().offset().left+l.offset().left+l.position().left+parseFloat(l.css("border-left-width")||0)));this.data(k,{top:c,left:l,width:U(m,
"width"),height:U(m,"height"),dataheight:U(u,"height")||"auto",datawidth:U(u,"width")||"auto"});m.remove();h.o&&h.o.remove()},ca=function(a,u,h){!0===u[0]&&(h="<span class='"+S("fm-button-icon",h,u[2])+"'></span>","right"===u[1]?a.addClass("fm-button-icon-right").append(h):a.addClass("fm-button-icon-left").prepend(h))},la=function(a){return"&nbsp;"===a||"&#160;"===a||1===a.length&&160===a.charCodeAt(0)};u.extend({searchGrid:function(k){return this.each(function(){function P(b){v("beforeShow",b)&&
(a(z).data("onClose",c.onClose),fa(z,{gbox:C,jqm:c.jqModal,overlay:c.overlay,modal:c.modal,overlayClass:c.overlayClass,toTop:c.toTop,onHide:function(a){pa.call(m,"searchProp",e,a)}}),v("afterShow",b))}var h=this,m=a(h),l=h.p;if(h.grid&&null!=l){var c=a.extend(!0,{recreateFilter:!1,drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:!1,
closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,removemodal:!0,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,onReset:null,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE","in":"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",
nu:"IS NULL",nn:"IS NOT NULL"}},G.getGridRes.call(m,"search"),u.search||{},l.searching||{},k||{}),e="fbox_"+l.id,r=c.commonIconClass,f={themodal:"searchmod"+e,modalhead:"searchhd"+e,modalcontent:"searchcnt"+e,resizeAlso:e},z="#"+D(f.themodal),C=l.gBox,d=l.gView,n=l.postData[c.sFilter],v=function(){var b=a.makeArray(arguments);b.unshift("Search");b.unshift("Filter");b.unshift(c);return ma.apply(h,b)};"string"===typeof n&&(n=""!==a.trim(n)?u.parse(n):void 0);!0===c.recreateFilter?a(z).remove():m.data("searchProp")&&
a.extend(c,m.data("searchProp"));if(void 0!==a(z)[0])P(a("#fbox_"+l.idSel));else{var t=a("<div><div id='"+e+"' class='searchFilter' style='overflow:auto'></div></div>").insertBefore(d);"rtl"===l.direction&&t.attr("dir","rtl");var B="",H="",I,b=!1,x,K=-1,p=a.extend([],l.colModel);x=R.call(h,e+"_search",c.Find,S(r,c.findDialogIcon),"right");var F=R.call(h,e+"_reset",c.Reset,S(r,c.resetDialogIcon),"left");c.showQuery&&(B=R.call(h,e+"_query","Query",S(r,c.queryDialogIcon),"left")+"&#160;");c.columns.length?
(p=c.columns,K=0,I=p[0].index||p[0].name):a.each(p,function(a,c){c.label||(c.label=l.colNames[a]);if(!b){var e=void 0===c.search?!0:c.search,d=!0===c.hidden;if(c.searchoptions&&!0===c.searchoptions.searchhidden&&e||e&&!d)b=!0,I=c.index||c.name,K=a}});if(!n&&I||!1===c.multipleSearch)r="eq",0<=K&&p[K].searchoptions&&p[K].searchoptions.sopt?r=p[K].searchoptions.sopt[0]:c.sopt&&c.sopt.length&&(r=c.sopt[0]),n={groupOp:"AND",rules:[{field:I,op:r,data:""}]};b=!1;c.tmplNames&&c.tmplNames.length&&(b=!0,H=
c.tmplLabel,H+="<select class='ui-template'>",H+="<option value='default'>Default</option>",a.each(c.tmplNames,function(a,b){H+="<option value='"+a+"'>"+b+"</option>"}),H+="</select>");x="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+e+"_2'><tbody><tr><td colspan='2'><hr class='"+Y.call(h,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='EditButton EditButton-"+l.direction+"'  style='float:"+("rtl"===l.direction?"right":"left")+";'>"+F+H+"</td><td class='EditButton EditButton-"+
l.direction+"'>"+B+x+"</td></tr></tbody></table>";e=D(e);c.gbox="#gbox_"+e;c.height="auto";e="#"+e;a(e).jqFilter({columns:p,filter:c.loadDefaults?n:null,showQuery:c.showQuery,errorcheck:c.errorcheck,sopt:c.sopt,groupButton:c.multipleGroup,ruleButtons:c.multipleSearch,afterRedraw:c.afterRedraw,ops:c.odata,cops:l.customSortOperations,operands:c.operands,ajaxSelectOptions:l.ajaxSelectOptions,groupOps:c.groupOps,onChange:function(){this.p.showQuery&&a(".query",this).html(this.toUserFriendlyString());
oa.call(h,c.afterChange,"jqGridFilterAfterChange",a(e),c)},direction:l.direction,id:l.id});t.append(x);b&&c.tmplFilters&&c.tmplFilters.length&&a(".ui-template",t).bind("change",function(){var b=a(this).val();"default"===b?a(e).jqFilter("addFilter",n):a(e).jqFilter("addFilter",c.tmplFilters[parseInt(b,10)]);return!1});!0===c.multipleGroup&&(c.multipleSearch=!0);v("onInitialize",a(e));c.layer?ga.call(h,f,t,c,d,a(C)[0],"#"+D(c.layer),{position:"relative"}):ga.call(h,f,t,c,d,a(C)[0]);(c.searchOnEnter||
c.closeOnEscape)&&a(z).keydown(function(b){var d=a(b.target);if(!(!c.searchOnEnter||13!==b.which||d.hasClass("add-group")||d.hasClass("add-rule")||d.hasClass("delete-group")||d.hasClass("delete-rule")||d.hasClass("fm-button")&&d.is("[id$=_query]")))return a(e+"_search").click(),!1;if(c.closeOnEscape&&27===b.which)return a("#"+D(f.modalhead)).find(".ui-jqdialog-titlebar-close").click(),!1});B&&a(e+"_query").bind("click",function(){a(".queryresult",t).toggle();return!1});void 0===c.stringResult&&(c.stringResult=
c.multipleSearch);a(e+"_search").bind("click",function(){var b={},d,n,f=a(e);n=f.find(".input-elm");n.filter(":focus")&&(n=n.filter(":focus"));n.change();n=f.jqFilter("filterData");if(c.errorcheck&&(f[0].hideError(),c.showQuery||f.jqFilter("toSQLString"),f[0].p.error))return f[0].showError(),!1;if(c.stringResult||"local"===l.datatype){try{d=xmlJsonClass.toJson(n,"","",!1)}catch(t){try{d=JSON.stringify(n)}catch(k){}}"string"===typeof d&&(b[c.sFilter]=d,a.each([c.sField,c.sValue,c.sOper],function(){b[this]=
""}))}else c.multipleSearch?(b[c.sFilter]=n,a.each([c.sField,c.sValue,c.sOper],function(){b[this]=""})):(b[c.sField]=n.rules[0].field,b[c.sValue]=n.rules[0].data,b[c.sOper]=n.rules[0].op,b[c.sFilter]="");l.search=!0;a.extend(l.postData,b);oa.call(h,c.onSearch,"jqGridFilterSearch",l.filters)&&m.trigger("reloadGrid",[a.extend({page:1},c.reloadGridSearchOptions||{})]);c.closeAfterSearch&&M(z,{gb:C,jqm:c.jqModal,onClose:c.onClose,removemodal:c.removemodal});return!1});a(e+"_reset").bind("click",function(){var d=
{},n=a(e);l.search=!1;l.resetsearch=!0;!1===c.multipleSearch?d[c.sField]=d[c.sValue]=d[c.sOper]="":d[c.sFilter]="";n[0].resetFilter();b&&a(".ui-template",t).val("default");a.extend(l.postData,d);oa.call(h,c.onReset,"jqGridFilterReset")&&m.trigger("reloadGrid",[a.extend({page:1},c.reloadGridResetOptions||{})]);c.closeAfterReset&&M(z,{gb:C,jqm:c.jqModal,onClose:c.onClose,removemodal:c.removemodal});return!1});P(a(e));var y=Q.call(h,"hover");a(".fm-button:not(."+Q.call(h,"disabled").split(" ").join(".")+
")",t).hover(function(){a(this).addClass(y)},function(){a(this).removeClass(y)})}}})},editGridRow:function(k,P){return this.each(function(){function h(){a(F+" > tbody > tr > td .FormElement").each(function(){var q=a(".customelement",this),c=this.name;if(q.length){if(c=q.attr("name"),q=da[c],void 0!==q&&(q=V[q],q=q.editoptions||{},a.isFunction(q.custom_value))){try{if(g[c]=q.custom_value.call(n,a("#"+D(c),F),"get"),void 0===g[c])throw"e1";}catch(d){"e1"===d?na.call(n,ha,"function 'custom_value' "+
b.msg.novalue,b.bClose):na.call(n,ha,d.message,b.bClose)}return!0}}else switch(q=a(this)[0].type,q){case "checkbox":g[c]=a(this).is(":checked")?a(this).val():a(this).data("offval");break;case "select-one":g[c]=a("option:selected",this).val();break;case "select-multiple":g[c]=a(this).val();g[c]=g[c]?g[c].join(","):"";a("option:selected",this).each(function(b,q){a(q).text()});break;case "date":g[c]=a(this).val();3===String(g[c]).split("-").length&&(q=da[c],void 0!==q&&(q=V[q],q=q.formatoptions||{},
q=q.newformat||H.call(v,"formatter.date.newformat"),g[c]=u.parseDate.call(v[0],"Y-m-d",g[c],q)));break;default:void 0!==q&&0>a.inArray(q,b.skipPostTypes)&&(g[c]=a(this).val())}});return!0}function m(q,c,g){var d=0,e=[],h=!1,l="",f;for(f=1;f<=g;f++)l+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";"_empty"!==q&&(h=G.getInd.call(v,q));a(V).each(function(f){var m=this.name,k,r,y,p,w;k=this.editable;var A=!1,v=!1;w="_empty"===q?"addForm":"editForm";a.isFunction(k)&&(k=k.call(n,{rowid:q,
iCol:f,iRow:h,cmName:m,cm:this,mode:w}));p=(this.editrules&&!0===this.editrules.edithidden?0:!0===this.hidden||"hidden"===k)?"style='display:none'":"";switch(String(k).toLowerCase()){case "hidden":k=!0;break;case "disabled":A=k=!0;break;case "readonly":v=k=!0}if("cb"!==m&&"subgrid"!==m&&!0===k&&"rn"!==m){if(!1===h)y="";else{k=a(n.rows[h].cells[f]);try{y=a.unformat.call(n,k,{rowId:q,colModel:this},f)}catch(z){y=this.edittype&&"textarea"===this.edittype?k.text():k.html()}la(y)&&(y="")}k=a.extend({},
this.editoptions||{},{id:m,name:m,rowId:q,mode:w});var L=a.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),E=parseInt(L.rowpos,10)||d+1,B=parseInt(2*(parseInt(L.colpos,10)||1),10);"_empty"===q&&k.defaultValue&&(y=a.isFunction(k.defaultValue)?k.defaultValue.call(n):k.defaultValue);this.edittype||(this.edittype="text");t.autoEncodeOnEdit&&(y=u.oldDecodePostedData(y));w=u.createEl.call(n,this.edittype,k,y,!1,a.extend({},u.ajaxOptions,t.ajaxSelectOptions||{}));if(b.checkOnSubmit||
b.checkOnUpdate)b._savedData[m]=y;a(w).addClass("FormElement");-1<a.inArray(this.edittype,["text","textarea","password","select"])&&a(w).addClass(Y.call(n,"dialog.dataField"));r=a(c).find("tr[data-rowpos="+E+"]");if(L.rowabove){var J=a("<tr><td class='contentinfo' colspan='"+2*g+"'>"+L.rowcontent+"</td></tr>");a(c).append(J);J[0].rp=E}0===r.length&&(r=a("<tr "+p+" data-rowpos='"+E+"'></tr>").addClass("FormData").attr("id","tr_"+m),a(r).append(l),a(c).append(r),r[0].rp=E);p=a("td:eq("+(B-2)+")",r[0]);
r=a("td:eq("+(B-1)+")",r[0]);p.html(void 0===L.label?t.colNames[f]:L.label||"&#160;");r[la(r.html())?"html":"append"](L.elmprefix).append(w).append(L.elmsuffix);A?(p.addClass(O),r.addClass(O),a(w).prop("readonly",!0),a(w).prop("disabled",!0)):v&&a(w).prop("readonly",!0);"custom"===this.edittype&&a.isFunction(k.custom_value)&&k.custom_value.call(n,a("#"+D(m),x),"set",y);u.bindEv.call(n,w,k);e[d]=f;d++}});0<d&&(f=a("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+
(2*g-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+B+"_id' value='"+q+"'/></td></tr>"),f[0].rp=d+999,a(c).append(f),b.checkOnSubmit||b.checkOnUpdate)&&(b._savedData[B+"_id"]=q);return e}function l(q,c){var g,d=0,e,f,h,l,k;if(b.checkOnSubmit||b.checkOnUpdate)b._savedData={},b._savedData[B+"_id"]=q;var m=t.colModel;if("_empty"===q)a(m).each(function(){g=this.name;h=a.extend({},this.editoptions||{});(f=a("#"+D(g),c))&&f.length&&null!==f[0]&&(l="","custom"===this.edittype&&
a.isFunction(h.custom_value)?h.custom_value.call(n,f,"set",l):h.defaultValue?(l=a.isFunction(h.defaultValue)?h.defaultValue.call(n):h.defaultValue,"checkbox"===f[0].type?(k=l.toLowerCase(),0>k.search(/(false|f|0|no|n|off|undefined)/i)&&""!==k?(f[0].checked=!0,f[0].defaultChecked=!0,f[0].value=l):(f[0].checked=!1,f[0].defaultChecked=!1)):f.val(l)):"checkbox"===f[0].type?(f[0].checked=!1,f[0].defaultChecked=!1,l=a(f).data("offval")):f[0].type&&"select"===f[0].type.substr(0,6)?f[0].selectedIndex=0:f.val(l),
!0===b.checkOnSubmit||b.checkOnUpdate)&&(b._savedData[g]=l)}),a("#id_g",c).val(q);else{var r=G.getInd.call(v,q,!0);r&&(a(r.cells).filter("td[role=gridcell]").each(function(f){g=m[f].name;if("cb"!==g&&"subgrid"!==g&&"rn"!==g&&!0===m[f].editable){try{e=a.unformat.call(n,a(this),{rowId:q,colModel:m[f]},f)}catch(h){e="textarea"===m[f].edittype?a(this).text():a(this).html()}t.autoEncodeOnEdit&&(e=u.oldDecodePostedData(e));if(!0===b.checkOnSubmit||b.checkOnUpdate)b._savedData[g]=e;g="#"+D(g);switch(m[f].edittype){case "password":case "text":case "button":case "image":case "textarea":la(e)&&
(e="");a(g,c).val(e);break;case "select":var l=e.split(","),l=a.map(l,function(b){return a.trim(b)});a(g+" option",c).each(function(){var b=a(this),g=a.trim(b.val()),b=a.trim(b.text());m[f].editoptions.multiple||a.trim(e)!==b&&l[0]!==b&&l[0]!==g?m[f].editoptions.multiple?-1<a.inArray(b,l)||-1<a.inArray(g,l)?this.selected=!0:this.selected=!1:this.selected=!1:this.selected=!0});break;case "checkbox":e=String(e);if(m[f].editoptions&&m[f].editoptions.value)if(m[f].editoptions.value.split(":")[0]===e)a(g,
c)[N]({checked:!0,defaultChecked:!0});else a(g,c)[N]({checked:!1,defaultChecked:!1});else e=e.toLowerCase(),0>e.search(/(false|f|0|no|n|off|undefined)/i)&&""!==e?(a(g,c)[N]("checked",!0),a(g,c)[N]("defaultChecked",!0)):(a(g,c)[N]("checked",!1),a(g,c)[N]("defaultChecked",!1));break;case "custom":try{if(m[f].editoptions&&a.isFunction(m[f].editoptions.custom_value))m[f].editoptions.custom_value.call(n,a(g,c),"set",e);else throw"e1";}catch(h){"e1"===h?na.call(n,ha,"function 'custom_value' "+b.msg.nodefined,
b.bClose):na.call(n,ha,h.message,b.bClose)}}d++}}),0<d&&a("#id_g",F).val(q))}}function c(){var c=b.url||t.editurl;a.each(V,function(b,d){var e=d.name,f=g[e];"date"!==d.formatter||null!=d.formatoptions&&!0===d.formatoptions.sendFormatted||(g[e]=a.unformat.date.call(n,f,d));"clientArray"!==c&&d.editoptions&&!0===d.editoptions.NullIfEmpty&&g.hasOwnProperty(e)&&""===f&&(g[e]="null")})}function e(){var q=[!0,"",""],d={},e=t.prmNames,f,h,m,r,p,A,L=G.getInd.call(v,k),z=!1===L?null:n.rows[L];(A=v.triggerHandler("jqGridAddEditBeforeCheckValues",
[a(x),J]))&&"object"===typeof A&&(g=A);L=!1===L?-1:L;a.isFunction(b.beforeCheckValues)&&(A=b.beforeCheckValues.call(n,g,a(x),J))&&"object"===typeof A&&(g=A);for(m in g)if(g.hasOwnProperty(m)&&(A=t.iColByName[m],q=u.checkValues.call(n,g[m],m,void 0,void 0,{oldValue:"_empty"===k?null:G.getCell.call(v,k,A),newValue:g[m],cmName:m,rowid:k,cm:V[A],iCol:A,iRow:L,tr:z,td:null==z?null:z.cells[A],mode:"_empty"===k?"addForm":"editForm"}),!1===q[0]))break;c();q[0]&&(d=v.triggerHandler("jqGridAddEditClickSubmit",
[b,g,J]),void 0===d&&a.isFunction(b.onclickSubmit)&&(d=b.onclickSubmit.call(n,b,g,J)||{}),q=v.triggerHandler("jqGridAddEditBeforeSubmit",[g,a(x),J]),void 0===q&&(q=[!0,"",""]),q[0]&&a.isFunction(b.beforeSubmit)&&(q=b.beforeSubmit.call(n,g,a(x),J)));if(q[0]&&!b.processing){b.processing=!0;a("#sData",y).addClass(ta);m=b.url||t.editurl;h=e.oper;f="clientArray"===m&&!1!==t.keyName?t.keyName:e.id;g[h]="_empty"===a.trim(g[B+"_id"])?e.addoper:e.editoper;g[h]!==e.addoper?g[f]=g[B+"_id"]:void 0===g[f]&&(g[f]=
g[B+"_id"]);delete g[B+"_id"];g=a.extend(g,b.editData,d);if(!0===t.treeGrid)for(p in g[h]===e.addoper&&(r=t.selrow,g["adjacency"===t.treeGridModel?t.treeReader.parent_id_field:"parent_id"]=r),t.treeReader)t.treeReader.hasOwnProperty(p)&&(d=t.treeReader[p],!g.hasOwnProperty(d)||g[h]===e.addoper&&"parent_id_field"===p||delete g[d]);g[f]=u.stripPref(t.idPrefix,g[f]);t.autoEncodeOnEdit&&a.each(g,function(b,c){a.isFunction(c)||(g[b]=u.oldEncodePostedData(c))});p=a.extend({url:a.isFunction(m)?m.call(n,
g[f],J,g,b):m,type:a.isFunction(b.mtype)?b.mtype.call(n,J,b,g[f],g):b.mtype,data:u.serializeFeedback.call(n,a.isFunction(b.serializeEditData)?b.serializeEditData:t.serializeEditData,"jqGridAddEditSerializeEditData",g),complete:function(c,d){a("#sData",y).removeClass(ta);g[f]=t.idPrefix+a("#id_g",F).val();300<=c.status&&304!==c.status||0===c.status&&4===c.readyState?(q[0]=!1,q[1]=v.triggerHandler("jqGridAddEditErrorTextFormat",[c,J]),a.isFunction(b.errorTextFormat)?q[1]=b.errorTextFormat.call(n,c,
J):q[1]=d+" Status: '"+c.statusText+"'. Error code: "+c.status):(q=v.triggerHandler("jqGridAddEditAfterSubmit",[c,g,J]),void 0===q&&(q=[!0,"",""]),q[0]&&a.isFunction(b.afterSubmit)&&(q=b.afterSubmit.call(n,c,g,J)));if(!1===q[0])a("#FormError>td",F).html(q[1]),a("#FormError",F).show();else{t.autoEncodeOnEdit&&a.each(g,function(a,b){g[a]=u.oldDecodePostedData(b)});var m=[a.extend({},b.reloadGridOptions||{})];g[h]===e.addoper?(q[2]||(q[2]=u.randId()),null==g[f]||"_empty"===g[f]||g[h]===e.addoper?g[f]=
q[2]:q[2]=g[f],b.reloadAfterSubmit?v.trigger("reloadGrid",m):!0===t.treeGrid?G.addChildNode.call(v,q[2],r,g):G.addRowData.call(v,q[2],g,b.addedrow),b.closeAfterAdd?(!0!==t.treeGrid&&I.call(v,q[2]),M(w,{gb:E,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form})):b.clearAfterAdd&&l("_empty",x)):(b.reloadAfterSubmit?(v.trigger("reloadGrid",m),b.closeAfterEdit||setTimeout(function(){I.call(v,g[f])},1E3)):!0===t.treeGrid?G.setTreeRow.call(v,g[f],g):G.setRowData.call(v,
g[f],g),b.closeAfterEdit&&M(w,{gb:E,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form}));if(a.isFunction(b.afterComplete)){var k=c;setTimeout(function(){v.triggerHandler("jqGridAddEditAfterComplete",[k,g,a(x),J]);b.afterComplete.call(n,k,g,a(x),J);k=null},50)}if(b.checkOnSubmit||b.checkOnUpdate)if(a(x).data("disabled",!1),"_empty"!==b._savedData[B+"_id"])for(var p in b._savedData)b._savedData.hasOwnProperty(p)&&g[p]&&(b._savedData[p]=g[p])}b.processing=
!1;try{a(":input:visible",x)[0].focus()}catch(A){}}},u.ajaxOptions,b.ajaxEditOptions);p.url||b.useDataProxy||(a.isFunction(t.dataProxy)?b.useDataProxy=!0:(q[0]=!1,q[1]+=" "+u.errors.nourl));q[0]&&(b.useDataProxy?(d=t.dataProxy.call(n,p,"set_"+B),void 0===d&&(d=[!0,""]),!1===d[0]?(q[0]=!1,q[1]=d[1]||"Error deleting the selected row!"):(p.data.oper===e.addoper&&b.closeAfterAdd&&M(w,{gb:E,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form}),p.data.oper===e.editoper&&
b.closeAfterEdit&&M(w,{gb:E,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form}))):"clientArray"===p.url?(b.reloadAfterSubmit=!1,g=p.data,p.complete({status:200,statusText:""},"")):a.ajax(p))}!1===q[0]&&(a("#FormError>td",F).html(q[1]),a("#FormError",F).show())}function r(a,b){var c=!1,g;for(g in a)if(a.hasOwnProperty(g)&&String(a[g])!==String(b[g])){c=!0;break}return c}function f(){var c=!0;a("#FormError",F).hide();b.checkOnUpdate&&(g={},h(),L=r(g,b._savedData))&&
(a(x).data("disabled",!0),a(".confirm",w).show(),c=!1);return c}function z(){var b=u.detectRowEditing.call(n,k);if(null!=b)if("inlineEditing"===b.mode)G.restoreRow.call(v,k);else{var b=b.savedRow,c=n.rows[b.id];G.restoreCell.call(v,b.id,b.ic);a(c.cells[b.ic]).removeClass("edit-cell "+ua);a(c).addClass(ua).attr({"aria-selected":"true",tabindex:"0"})}}function C(b,c){var g=c[1].length-1;0===b?a("#pData",y).addClass(O):void 0!==c[1][b-1]&&T(a("#"+D(c[1][b-1])),O)?a("#pData",y).addClass(O):a("#pData",
y).removeClass(O);b===g?a("#nData",y).addClass(O):void 0!==c[1][b+1]&&T(a("#"+D(c[1][b+1])),O)?a("#nData",y).addClass(O):a("#nData",y).removeClass(O)}function d(){var b=G.getDataIDs.call(v),c=a("#id_g",F).val();return[a.inArray(c,b),b]}var n=this,v=a(n),t=n.p;if(n.grid&&null!=t&&k){var B=t.id,H=G.getGridRes,I=G.setSelection,b=a.extend(!0,{top:0,left:0,width:300,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,
onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:!1,closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:"ui-widget-overlay",removemodal:!0,
skipPostTypes:["image","file"],form:"edit"},H.call(v,"edit"),u.edit,t.formEditing||{},P||{}),x="FrmGrid_"+B,K=x,p="TblGrid_"+B,F="#"+D(p),y=F+"_2",A={themodal:"editmod"+B,modalhead:"edithd"+B,modalcontent:"editcnt"+B,resizeAlso:x},w="#"+D(A.themodal),E=t.gBox,N=t.propOrAttr,V=t.colModel,da=t.iColByName,ea=1,Z=0,g,L,J,ia=b.commonIconClass,ha=H.call(v,"errors.errcap"),W=function(){var c=a.makeArray(arguments);c.unshift("");c.unshift("AddEdit");c.unshift(b);return ma.apply(n,c)},va=Q.call(n,"hover"),
O=Q.call(n,"disabled"),ua=Q.call(n,"select"),ta=Q.call(n,"active"),X=Q.call(n,"error"),x="#"+D(x);"new"===k?(k="_empty",J="add",b.caption=b.addCaption):(b.caption=b.editCaption,J="edit");if(!b.recreateForm){var aa=v.data("formProp");aa&&(aa.top=Math.max(aa.top,0),aa.left=Math.max(aa.left,0),a.extend(b,aa))}aa=!0;!b.checkOnUpdate||!0!==b.jqModal&&void 0!==b.jqModal||b.modal||(aa=!1);var ja=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px",ba=isNaN(b.datawidth)?b.datawidth:b.datawidth+"px",K=a("<form name='FormPost' id='"+
K+"' class='FormGrid' onSubmit='return false;' style='width:"+ba+";overflow:auto;position:relative;height:"+ja+";'></form>").data("disabled",!1),ka=a("<table id='"+p+"' class='EditTable'"+(u.msie&&8>u.msiever()?" cellspacing='0'":"")+"><tbody></tbody></table>");a(V).each(function(){var a=this.formoptions;ea=Math.max(ea,a?a.colpos||0:0);Z=Math.max(Z,a?a.rowpos||0:0)});a(K).append(ka);X=a("<tr id='FormError' style='display:none'><td class='"+X+"' colspan='"+2*ea+"'>&#160;</td></tr>");X[0].rp=0;a(ka).append(X);
X=a("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*ea+"'>"+(b.topinfo||"&#160;")+"</td></tr>");X[0].rp=0;a(ka).append(X);if(W("beforeInitData",K,J)){z();ja=(X="rtl"===t.direction?!0:!1)?"nData":"pData";ba=X?"pData":"nData";m(k,ka,ea);var ja=R.call(n,ja,"",S(ia,b.prevIcon),"","left"),ba=R.call(n,ba,"",S(ia,b.nextIcon),"","right"),qa=R.call(n,"sData",b.bSubmit),ra=R.call(n,"cData",b.bCancel),p="<table"+(u.msie&&8>u.msiever()?" cellspacing='0'":"")+" class='EditTable' id='"+
p+"_2'><tbody><tr><td colspan='2'><hr class='"+Y.call(n,"dialog.hr")+"' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton navButton-"+t.direction+"'>"+(X?ba+ja:ja+ba)+"</td><td class='EditButton EditButton-"+t.direction+"'>"+qa+"&#160;"+ra+"</td></tr>",p=p+("<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+(b.bottominfo||"&#160;")+"</td></tr>"),p=p+"</tbody></table>";if(0<Z){var sa=[];a.each(a(ka)[0].rows,function(a,b){sa[a]=b});sa.sort(function(a,
b){return a.rp>b.rp?1:a.rp<b.rp?-1:0});a.each(sa,function(b,c){a("tbody",ka).append(c)})}b.gbox=E;var U=!1;!0===b.closeOnEscape&&(b.closeOnEscape=!1,U=!0);p=a("<div></div>").append(K).append(p);ga.call(n,A,p,b,t.gView,a(E)[0]);b.topinfo&&a(".tinfo",F).show();b.bottominfo&&a(".binfo",y).show();p=p=null;a(w).keydown(function(c){var g=(c.target.tagName||"").toUpperCase(),d,e;if(!0===a(x).data("disabled"))return!1;if(13===c.which&&"TEXTAREA"!==g){d=a(y).find(":focus");e=d.attr("id");if(0<d.length&&0<=
a.inArray(e,["pData","nData","cData"]))return d.trigger("click"),!1;if(!0===b.savekey[0]&&13===b.savekey[1])return a("#sData",y).trigger("click"),!1}if(!0===b.savekey[0]&&c.which===b.savekey[1]&&"TEXTAREA"!==g)return a("#sData",y).trigger("click"),!1;if(27===c.which){if(!f())return!1;U&&M(w,{gb:b.gbox,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form});return!1}if(!0===b.navkeys[0]){if("_empty"===a("#id_g",F).val())return!0;if(c.which===b.navkeys[1])return a("#pData",
y).trigger("click"),!1;if(c.which===b.navkeys[2])return a("#nData",y).trigger("click"),!1}});b.checkOnUpdate&&(a("a.ui-jqdialog-titlebar-close span",w).removeClass("jqmClose"),a("a.ui-jqdialog-titlebar-close",w).unbind("click").click(function(){if(!f())return!1;M(w,{gb:E,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form});return!1}));ca(a("#sData",y),b.saveicon,ia);ca(a("#cData",y),b.closeicon,ia);if(b.checkOnSubmit||b.checkOnUpdate)qa=R.call(n,"sNew",
b.bYes),ba=R.call(n,"nNew",b.bNo),ra=R.call(n,"cNew",b.bExit),A=b.zIndex||999,A++,a("<div class='"+b.overlayClass+" jqgrid-overlay confirm' style='z-index:"+A+";display:none;'>&#160;</div><div class='"+Y.call(n,"dialog.content","confirm ui-jqconfirm")+"' style='z-index:"+(A+1)+"'>"+b.saveData+"<br/><br/>"+qa+ba+ra+"</div>").insertAfter(x),a("#sNew",w).click(function(){e();a(x).data("disabled",!1);a(".confirm",w).hide();return!1}),a("#nNew",w).click(function(){a(".confirm",w).hide();a(x).data("disabled",
!1);setTimeout(function(){a(":input:visible",x)[0].focus()},0);return!1}),a("#cNew",w).click(function(){a(".confirm",w).hide();a(x).data("disabled",!1);M(w,{gb:E,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form});return!1});W("onInitializeForm",a(x),J);"_empty"!==k&&b.viewPagerButtons?a("#pData,#nData",y).show():a("#pData,#nData",y).hide();W("beforeShowForm",a(x),J);a(w).data("onClose",b.onClose);fa(w,{gbox:E,jqm:b.jqModal,overlay:b.overlay,modal:b.modal,
overlayClass:b.overlayClass,toTop:b.toTop,onHide:function(a){pa.call(v,"formProp",x,a)}});aa||a("."+D(b.overlayClass)).click(function(){if(!f())return!1;M(w,{gb:E,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form});return!1});a(".fm-button",w).hover(function(){a(this).addClass(va)},function(){a(this).removeClass(va)});a("#sData",y).click(function(){g={};a("#FormError",F).hide();h();"_empty"===g[B+"_id"]?e():!0===b.checkOnSubmit?(L=r(g,b._savedData))?(a(x).data("disabled",
!0),a(".confirm",w).show()):e():e();return!1});a("#cData",y).click(function(){if(!f())return!1;M(w,{gb:E,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form});return!1});a("#nData",y).click(function(){if(!f())return!1;a("#FormError",F).hide();var b=d();b[0]=parseInt(b[0],10);if(-1!==b[0]&&b[1][b[0]+1]){if(!W("onclickPgButtons","next",a(x),b[1][b[0]]))return!1;l(b[1][b[0]+1],x);I.call(v,b[1][b[0]+1]);W("afterclickPgButtons","next",a(x),b[1][b[0]+1]);C(b[0]+
1,b)}return!1});a("#pData",y).click(function(){if(!f())return!1;a("#FormError",F).hide();var b=d();if(-1!==b[0]&&b[1][b[0]-1]){if(!W("onclickPgButtons","prev",a(x),b[1][b[0]])||T(a("#"+D(b[1][b[0]-1])),O))return!1;l(b[1][b[0]-1],x);I.call(v,b[1][b[0]-1]);W("afterclickPgButtons","prev",a(x),b[1][b[0]-1]);C(b[0]-1,b)}return!1});W("afterShowForm",a(x),J);A=d();C(A[0],A)}}})},viewGridRow:function(k,P){return this.each(function(){function h(){!0!==d.closeOnEscape&&!0!==d.navkeys[0]||setTimeout(function(){a(".ui-jqdialog-titlebar-close",
"#"+D(b.modalhead)).attr("tabindex","-1").focus()},0)}function m(b,c,e){var h,m,l,n=0,k,t,y=[],A=G.getInd.call(f,b),w;w=Y.call(r,"dialog.viewData","DataTD form-view-data");var v=Y.call(r,"dialog.viewLabel","CaptionTD form-view-label"),x="<td class='"+v+"' width='"+d.labelswidth+"'>&#160;</td><td class='"+w+" ui-helper-reset'>&#160;</td>",E="",v="<td class='"+v+"'></td><td class='"+w+"'></td>",B=["integer","number","currency"],C=0,D=0,F,q,H;for(w=1;w<=e;w++)E+=1===w?x:v;a(p).each(function(){(m=this.editrules&&
!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1)||"right"!==this.align||(this.formatter&&-1!==a.inArray(this.formatter,B)?C=Math.max(C,parseInt(this.width,10)):D=Math.max(D,parseInt(this.width,10)))});F=0!==C?C:0!==D?D:0;a(p).each(function(b){h=this.name;q=!1;t=(m=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1)?"style='display:none'":"";H="boolean"!==typeof this.viewable?!0:this.viewable;if("cb"!==h&&"subgrid"!==h&&"rn"!==h&&H){k=!1===A?"":u.getDataFieldOfCell.call(r,
r.rows[A],b).html();q="right"===this.align&&0!==F?!0:!1;var g=a.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),d=parseInt(g.rowpos,10)||n+1,f=parseInt(2*(parseInt(g.colpos,10)||1),10);if(g.rowabove){var p=a("<tr><td class='contentinfo' colspan='"+2*e+"'>"+g.rowcontent+"</td></tr>");a(c).append(p);p[0].rp=d}l=a(c).find("tr[data-rowpos="+d+"]");0===l.length&&(l=a("<tr "+t+" data-rowpos='"+d+"'></tr>").addClass("FormData").attr("id","trv_"+h),a(l).append(E),a(c).append(l),l[0].rp=d);g=void 0===
g.label?z.colNames[b]:g.label;d=a("td:eq("+(f-1)+")",l[0]);a("td:eq("+(f-2)+")",l[0]).html("<b>"+(g||"&nbsp;")+"</b>");d[la(d.html())?"html":"append"]("<span>"+(k||"&nbsp;")+"</span>").attr("id","v_"+h);q&&a("td:eq("+(f-1)+") span",l[0]).css({"text-align":"right",width:F+"px"});y[n]=b;n++}});0<n&&(b=a("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*e-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+b+"'/></td></tr>"),
b[0].rp=n+99,a(c).append(b));return y}function l(b){var c,d,e=0,h=G.getInd.call(f,b,!0),l;h&&(a("td",h).each(function(b){l=p[b];c=l.name;d=l.editrules&&!0===l.editrules.edithidden?!1:!0===l.hidden?!0:!1;"cb"!==c&&"subgrid"!==c&&"rn"!==c&&(c=D("v_"+c),a("#"+c+" span",v).html(u.getDataFieldOfCell.call(r,h,b).html()),d&&a("#"+c,v).parents("tr:first").hide(),e++)}),0<e&&a("#id_g",v).val(b))}function c(b,c){var d=c[1].length-1;0===b?a("#pData",t).addClass(E):void 0!==c[1][b-1]&&T(a("#"+D(c[1][b-1])),E)?
a("#pData",t).addClass(E):a("#pData",t).removeClass(E);b===d?a("#nData",t).addClass(E):void 0!==c[1][b+1]&&T(a("#"+D(c[1][b+1])),E)?a("#nData",t).addClass(E):a("#nData",t).removeClass(E)}function e(){var b=G.getDataIDs.call(f),c=a("#id_g",v).val();return[a.inArray(c,b),b]}var r=this,f=a(r),z=r.p;if(r.grid&&null!=z&&k){var C=z.id,d=a.extend(!0,{top:0,left:0,width:0,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,closeOnEscape:!1,labelswidth:"30%",navkeys:[!1,38,40],onClose:null,
beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,recreateForm:!1,removemodal:!0,form:"view"},G.getGridRes.call(f,"view"),u.view||{},z.formViewing||{},P||{}),n="#ViewGrid_"+D(C),v="#ViewTbl_"+D(C),t=v+"_2",B="ViewGrid_"+C,H="ViewTbl_"+C,I=d.commonIconClass,b={themodal:"viewmod"+C,modalhead:"viewhd"+C,modalcontent:"viewcnt"+C,resizeAlso:B},x="#"+D(b.themodal),K=z.gBox,p=z.colModel,F=1,y=0,A=function(){var b=a.makeArray(arguments);b.unshift("");b.unshift("View");b.unshift(d);return ma.apply(r,
b)},w=Q.call(r,"hover"),E=Q.call(r,"disabled");d.recreateForm||f.data("viewProp")&&a.extend(d,f.data("viewProp"));var C=isNaN(d.dataheight)?d.dataheight:d.dataheight+"px",N=isNaN(d.datawidth)?d.datawidth:d.datawidth+"px",B=a("<form name='FormPost' id='"+B+"' class='FormGrid' style='width:"+N+";overflow:auto;position:relative;height:"+C+";'></form>"),V=a("<table id='"+H+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");a(p).each(function(){var a=
this.formoptions;F=Math.max(F,a?a.colpos||0:0);y=Math.max(y,a?a.rowpos||0:0)});B.append(V);if(A("beforeInitData",B)){m(k,V,F);var da=(C="rtl"===z.direction?!0:!1)?"pData":"nData",N=R.call(r,C?"nData":"pData","",S(I,d.prevIcon),"","left"),da=R.call(r,da,"",S(I,d.nextIcon),"","right"),ea=R.call(r,"cData",d.bClose);if(0<y){var Z=[];a.each(a(V)[0].rows,function(a,b){Z[a]=b});Z.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0});a.each(Z,function(b,c){a("tbody",V).append(c)})}d.gbox=K;H=a("<div></div>").append(B).append("<table border='0' class='EditTable' id='"+
H+"_2'><tbody><tr id='Act_Buttons'><td class='navButton navButton-"+z.direction+"' width='"+(d.labelswidth||"auto")+"'>"+(C?da+N:N+da)+"</td><td class='EditButton EditButton-"+z.direction+"'>"+ea+"</td></tr></tbody></table>");ga.call(r,b,H,d,z.gView,a(z.gView)[0]);d.viewPagerButtons||a("#pData, #nData",t).hide();H=null;a(x).keydown(function(b){var c,e;if(!0===a(n).data("disabled"))return!1;if(13===b.which&&(c=a(t).find(":focus"),e=c.attr("id"),0<c.length&&0<=a.inArray(e,["pData","nData","cData"])))return c.trigger("click"),
!1;if(27===b.which)return d.closeOnEscape&&M(x,{gb:K,jqm:d.jqModal,onClose:d.onClose,removemodal:d.removemodal,formprop:!d.recreateForm,form:d.form}),!1;if(!0===d.navkeys[0]){if(b.which===d.navkeys[1])return a("#pData",t).trigger("click"),!1;if(b.which===d.navkeys[2])return a("#nData",t).trigger("click"),!1}});ca(a("#cData",t),d.closeicon,I);A("beforeShowForm",a(n));fa(x,{gbox:K,jqm:d.jqModal,overlay:d.overlay,toTop:d.toTop,modal:d.modal,onHide:function(a){pa.call(f,"viewProp",n,a)}});a(".fm-button:not(."+
E.split(" ").join(".")+")",t).hover(function(){a(this).addClass(w)},function(){a(this).removeClass(w)});h();a("#cData",t).click(function(){M(x,{gb:K,jqm:d.jqModal,onClose:d.onClose,removemodal:d.removemodal,formprop:!d.recreateForm,form:d.form});return!1});a("#nData",t).click(function(){a("#FormError",v).hide();var b=e();b[0]=parseInt(b[0],10);if(-1!==b[0]&&b[1][b[0]+1]){if(!A("onclickPgButtons","next",a(n),b[1][b[0]]))return!1;l(b[1][b[0]+1]);G.setSelection.call(f,b[1][b[0]+1]);A("afterclickPgButtons",
"next",a(n),b[1][b[0]+1]);c(b[0]+1,b)}h();return!1});a("#pData",t).click(function(){a("#FormError",v).hide();var b=e();if(-1!==b[0]&&b[1][b[0]-1]){if(!A("onclickPgButtons","prev",a(n),b[1][b[0]]))return!1;l(b[1][b[0]-1]);G.setSelection.call(f,b[1][b[0]-1]);A("afterclickPgButtons","prev",a(n),b[1][b[0]-1]);c(b[0]-1,b)}h();return!1});I=e();c(I[0],I)}}})},delGridRow:function(k,P){return this.each(function(){var h=this,m=h.p,l=a(h);if(h.grid&&null!=m&&k){var c=m.id,e=a.extend(!0,{top:0,left:0,width:240,
removemodal:!0,height:"auto",dataheight:"auto",drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,closeOnEscape:!1,delData:{},onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},G.getGridRes.call(l,"del"),u.del||{},m.formDeleting||{},P||{}),r="DelTbl_"+c,f="#DelTbl_"+D(c),z,C,d,n,v={themodal:"delmod"+c,modalhead:"delhd"+c,modalcontent:"delcnt"+c,
resizeAlso:r},t="#"+D(v.themodal),B=m.gBox,H=e.commonIconClass,I=function(){var b=a.makeArray(arguments);b.unshift("");b.unshift("Delete");b.unshift(e);return ma.apply(h,b)},b=Q.call(h,"hover"),x=Q.call(h,"active"),K=Q.call(h,"error");a.isArray(k)||(k=[String(k)]);if(void 0!==a(t)[0]){if(!I("beforeInitData",a(f)))return;a("#DelData>td",f).text(k.join()).data("rowids",k);a("#DelError",f).hide();!0===e.processing&&(e.processing=!1,a("#dData",f).removeClass(x));I("beforeShowForm",a(f));fa(t,{gbox:B,
jqm:e.jqModal,jqM:!1,overlay:e.overlay,toTop:e.toTop,modal:e.modal})}else{var p=isNaN(e.dataheight)?e.dataheight:e.dataheight+"px",F=isNaN(e.datawidth)?e.datawidth:e.datawidth+"px",p="<div id='"+r+"' class='formdata' style='width:"+F+";overflow:auto;position:relative;height:"+p+";'><table class='DelTable'><tbody>",p=p+("<tr id='DelError' style='display:none'><td class='"+K+"'></td></tr>"),p=p+("<tr id='DelData' style='display:none'><td >"+k.join()+"</td></tr>"),p=p+("<tr><td class='delmsg' style='white-space:pre;'>"+
e.msg+"</td></tr><tr><td >&#160;</td></tr>"),p=p+"</tbody></table></div>",K=R.call(h,"dData",e.bSubmit),F=R.call(h,"eData",e.bCancel),p=p+("<table"+(u.msie&&8>u.msiever()?" cellspacing='0'":"")+" class='EditTable' id='"+r+"_2'><tbody><tr><td><hr class='"+Y.call(h,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton EditButton-"+m.direction+"'>"+K+"&#160;"+F+"</td></tr></tbody></table>");e.gbox=B;ga.call(h,v,p,e,m.gView,a(m.gView)[0]);a("#DelData>td",f).data("rowids",k);
if(!I("beforeInitData",a(p)))return;a(".fm-button",f+"_2").hover(function(){a(this).addClass(b)},function(){a(this).removeClass(b)});ca(a("#dData",f+"_2"),e.delicon,H);ca(a("#eData",f+"_2"),e.cancelicon,H);a("#dData",f+"_2").click(function(){var b=[!0,""],k,r=a("#DelData>td",f),p=r.text(),v=r.data("rowids"),r={};a.isFunction(e.onclickSubmit)&&(r=e.onclickSubmit.call(h,e,p)||{});a.isFunction(e.beforeSubmit)&&(b=e.beforeSubmit.call(h,p));if(b[0]&&!e.processing){e.processing=!0;d=m.prmNames;z=a.extend({},
e.delData,r);n=d.oper;z[n]=d.deloper;C=d.id;p=v.slice();if(!p.length)return!1;for(k in p)p.hasOwnProperty(k)&&(p[k]=u.stripPref(m.idPrefix,p[k]));z[C]=p.join();a(this).addClass(x);k=e.url||m.editurl;k=a.extend({url:a.isFunction(k)?k.call(h,z[C],z,e):k,type:e.mtype,data:a.isFunction(e.serializeDelData)?e.serializeDelData.call(h,z):z,complete:function(c,d){var k;a("#dData",f+"_2").removeClass(x);300<=c.status&&304!==c.status||0===c.status&&4===c.readyState?(b[0]=!1,a.isFunction(e.errorTextFormat)?b[1]=
e.errorTextFormat.call(h,c):b[1]=d+" Status: '"+c.statusText+"'. Error code: "+c.status):a.isFunction(e.afterSubmit)&&(b=e.afterSubmit.call(h,c,z));if(!1===b[0])a("#DelError>td",f).html(b[1]),a("#DelError",f).show();else{if(e.reloadAfterSubmit&&"local"!==m.datatype)l.trigger("reloadGrid",[a.extend({},e.reloadGridOptions||{})]);else if(!0===m.treeGrid)try{G.delTreeNode.call(l,v[0])}catch(n){}else for(v=v.slice(),k=0;k<v.length;k++)G.delRowData.call(l,v[k]);setTimeout(function(){I("afterComplete",c,
p,a(f))},50)}e.processing=!1;b[0]&&M(t,{gb:B,jqm:e.jqModal,onClose:e.onClose,removemodal:e.removemodal})}},u.ajaxOptions,e.ajaxDelOptions);k.url||e.useDataProxy||(a.isFunction(m.dataProxy)?e.useDataProxy=!0:(b[0]=!1,b[1]+=" "+u.errors.nourl));b[0]&&(e.useDataProxy?(k=m.dataProxy.call(h,k,"del_"+c),void 0===k&&(k=[!0,""]),!1===k[0]?(b[0]=!1,b[1]=k[1]||"Error deleting the selected row!"):M(t,{gb:B,jqm:e.jqModal,onClose:e.onClose,removemodal:e.removemodal})):"clientArray"===k.url?(z=k.data,k.complete({status:200,
statusText:""},"")):a.ajax(k))}!1===b[0]&&(a("#DelError>td",f).html(b[1]),a("#DelError",f).show());return!1});a("#eData",f+"_2").click(function(){M(t,{gb:B,jqm:e.jqModal,onClose:e.onClose,removemodal:e.removemodal});return!1});I("beforeShowForm",a(f));fa(t,{gbox:B,jqm:e.jqModal,overlay:e.overlay,toTop:e.toTop,modal:e.modal})}I("afterShowForm",a(f));!0===e.closeOnEscape&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+D(v.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(k,
P,h,m,l,c,e){"object"===typeof k&&(e=c,c=l,l=m,m=h,h=P,P=k,k=void 0);m=m||{};h=h||{};e=e||{};l=l||{};c=c||{};return this.each(function(){var r=this,f=r.p,z=a(r);if(r.grid&&null!=f&&!(r.nav&&0<a(k).find(".navtable").length)){var C=f.id,d=a.extend({edit:!0,add:!0,del:!0,search:!0,refresh:!0,refreshstate:"firstpage",view:!1,closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,hideEmptyPagerParts:!0,alertwidth:200,alertheight:"auto",alerttop:null,removemodal:!0,alertleft:null,alertzIndex:null,
iconsOverText:!1},G.getGridRes.call(z,"nav"),u.nav||{},f.navOptions||{},P||{});d.position=d.position||("rtl"===f.direction?"right":"left");var n,v=f.idSel,t=f.gBox,B=d.commonIconClass,H={themodal:"alertmod_"+C,modalhead:"alerthd_"+C,modalcontent:"alertcnt_"+C},I=function(){return function(){var b=document.documentElement,c=window,e=1024,g=768,h=z.closest(".ui-jqgrid").offset();void 0===a("#"+D(H.themodal))[0]&&(d.alerttop||d.alertleft||(void 0!==c.innerWidth?(e=c.innerWidth,g=c.innerHeight):null!=
b&&void 0!==b.clientWidth&&0!==b.clientWidth&&(e=b.clientWidth,g=b.clientHeight),e=e/2-parseInt(d.alertwidth,10)/2-h.left,g=g/2-25-h.top),ga.call(r,H,"<div>"+d.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='"+C+"_jqg_alrt'></span></span>",{gbox:t,jqModal:d.jqModal,drag:!0,resize:!0,caption:d.alertcap,top:null!=d.alerttop?d.alerttop:g,left:null!=d.alertleft?d.alertleft:e,width:d.alertwidth,height:d.alertheight,closeOnEscape:d.closeOnEscape,zIndex:d.alertzIndex,removemodal:d.removemodal},
f.gView,a(t)[0],!1));fa("#"+D(H.themodal),{gbox:t,toTop:d.alertToTop,jqm:d.jqModal});var k=a("#"+D(H.modalhead)).find(".ui-jqdialog-titlebar-close");k.attr({tabindex:"0",href:"#",role:"button"});setTimeout(function(){k.focus()},50)}}(),b,x=function(b){if(13===b.which&&(b=a(this).find(".ui-pg-button").filter(":focus"),0<b.length))return b.trigger("click"),!1},K=Q.call(r,"hover"),p=Q.call(r,"disabled");if(r.grid){r.modalAlert=I;void 0===k&&(f.pager?(k=f.pager,f.toppager&&(d.cloneToTop=!0)):f.toppager&&
(k=f.toppager));var F=1,y,A,w,E,N,M=["left","center","right"],R="<div class='ui-pg-button "+p+"'><span class='ui-separator'></span></div>",U=function(){T(this,p)||a(this).addClass(K)},Z=function(){a(this).removeClass(K)},g=function(){T(this,p)||(a.isFunction(d.addfunc)?d.addfunc.call(r):G.editGridRow.call(z,"new",m));return!1},L=function(b,c,d){if(!T(this,p)){var e=f.selrow;e?a.isFunction(b)?b.call(r,e):G[c].call(z,e,d):I()}return!1},J=function(){return L.call(this,d.editfunc,"editGridRow",h)},ia=
function(){return L.call(this,d.viewfunc,"viewGridRow",e)},ha=function(){var b;T(this,p)||(f.multiselect?(b=f.selarrrow,0===b.length&&(b=null)):b=f.selrow,b?a.isFunction(d.delfunc)?d.delfunc.call(r,b):G.delGridRow.call(z,b,l):I());return!1},W=function(){T(this,p)||(a.isFunction(d.searchfunc)?d.searchfunc.call(r,c):G.searchGrid.call(z,c));return!1},ca=function(){if(!T(this,p)){a.isFunction(d.beforeRefresh)&&d.beforeRefresh.call(r);f.search=!1;f.resetsearch=!0;try{if("currentfilter"!==d.refreshstate){f.postData.filters=
"";try{a("#fbox_"+v).jqFilter("resetFilter")}catch(b){}a.isFunction(r.clearToolbar)&&r.clearToolbar(!1)}}catch(b){}switch(d.refreshstate){case "firstpage":z.trigger("reloadGrid",[a.extend({},d.reloadGridOptions||{},{page:1})]);break;case "current":case "currentfilter":z.trigger("reloadGrid",[a.extend({},d.reloadGridOptions||{},{current:!0})])}a.isFunction(d.afterRefresh)&&d.afterRefresh.call(r)}return!1},O=function(b,c,e,f,g){var h=a("<div class='ui-pg-button ui-corner-all' tabindex='0' role='button'></div>"),
k=d[b+"icon"],l=a.trim(d[b+"text"]);h.append("<div class='ui-pg-div'><span class='"+(d.iconsOverText?S("ui-pg-button-icon-over-text",B,k):S(B,k))+"'></span>"+(l?"<span class='ui-pg-button-text"+(d.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+l+"</span>":"")+"</div>");a(f).append(h);h.attr({title:d[b+"title"]||"",id:c||b+"_"+g}).click(e).hover(U,Z);return h};d.cloneToTop&&f.toppager&&(F=2);for(y=0;y<F;y++){b=a("<div class='ui-pg-table navtable' role='toolbar' style='float:"+("rtl"===f.direction?
"right":"left")+";table-layout:auto;'></div>");0===y?(A=k,w=C,A===f.toppager&&(w+="_top",F=1)):(A=f.toppager,w=C+"_top");d.add&&O("add",m.id,g,b,w);d.edit&&O("edit",h.id,J,b,w);d.view&&O("view",e.id,ia,b,w);d.del&&O("del",l.id,ha,b,w);(d.add||d.edit||d.del||d.view)&&a(b).append(R);d.search&&(n=O("search",c.id,W,b,w),c.showOnLoad&&!0===c.showOnLoad&&a(n,b).click());d.refresh&&O("refresh","",ca,b,w);n=a(".ui-jqgrid>.ui-jqgrid-view").css("font-size")||"11px";a("body").append("<div id='testpg2' class='"+
Y.call(r,"gBox","ui-jqgrid")+"' style='font-size:"+n+";visibility:hidden;' ></div>");n=a(b).clone().appendTo("#testpg2").width();a("#testpg2").remove();a(A+"_"+d.position,A).append(b);if(d.hideEmptyPagerParts)for(w=0;w<M.length;w++)M[w]!==d.position&&(N=a(A+"_"+M[w],A),0===N.length||0===N[0].childNodes.length?N.hide():1===N[0].childNodes.length&&(E=N[0].firstChild,!a(E).is("table.ui-pg-table")||0!==E.rows&&0!==E.rows[0].cells.length||N.hide()));f._nvtd&&(n>f._nvtd[0]&&(a(A+"_"+d.position,A).width(n),
f._nvtd[0]=n),f._nvtd[1]=n);r.nav=!0;b.bind("keydown.jqGrid",x)}z.triggerHandler("jqGridResetFrozenHeights")}}})},navButtonAdd:function(k,P){"object"===typeof k&&(P=k,k=void 0);return this.each(function(){var h=this,m=h.p;if(h.grid){var l=a.extend({caption:"newButton",title:"",onClickButton:null,position:"last",cursor:"pointer",iconsOverText:!1},G.getGridRes.call(a(h),"nav"),u.nav||{},m.navOptions||{},P||{}),c=Q.call(h,"hover"),e=Q.call(h,"disabled");if(void 0===k)if(m.pager)if(G.navButtonAdd.call(a(h),
m.pager,l),m.toppager)k=m.toppager;else return;else m.toppager&&(k=m.toppager);"string"===typeof k&&0!==k.indexOf("#")&&(k="#"+D(k));var m=a(".navtable",k),r=l.commonIconClass;if(0<m.length&&!(l.id&&0<m.find("#"+D(l.id)).length)){var f=a("<div tabindex='0' role='button'></div>");"NONE"===l.buttonicon.toString().toUpperCase()?a(f).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+(l.caption?"<span class='ui-pg-button-text"+(l.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+
l.caption+"</span>":"")+"</div>"):a(f).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='"+(l.iconsOverText?S("ui-pg-button-icon-over-text",r,l.buttonicon):S(r,l.buttonicon))+"'></span>"+(l.caption?"<span class='ui-pg-button-text"+(l.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+l.caption+"</span>":"")+"</div>");l.id&&a(f).attr("id",l.id);"first"===l.position&&0<m.children("div.ui-pg-button").length?m.children("div.ui-pg-button").first().before(f):m.append(f);
a(f,m).attr("title",l.title||"").click(function(c){T(this,e)||a.isFunction(l.onClickButton)&&l.onClickButton.call(h,l,c);return!1}).hover(function(){T(this,e)||a(this).addClass(c)},function(){a(this).removeClass(c)});a(h).triggerHandler("jqGridResetFrozenHeights")}}})},navSeparatorAdd:function(k,u){u=a.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},u||{});return this.each(function(){if(this.grid){"string"===typeof k&&0!==k.indexOf("#")&&(k="#"+D(k));var h=a(".navtable",k)[0];if(0<
h.length){var m="<div class='ui-pg-button "+Q.call(this,"disabled")+"'><span class='"+u.sepclass+"'></span>"+u.sepcontent+"</div>";"first"===u.position?0===a(">div.ui-pg-button",h).length?h.append(m):a(">div.ui-pg-button",h).first().before(m):h.append(m)}}})},GridToForm:function(k,u){return this.each(function(){var h,m,l,c;if(this.grid){var e=G.getRowData.call(a(this),k),r=this.p.propOrAttr;if(e)for(h in e)if(e.hasOwnProperty(h))if(m=a("[name="+D(h)+"]",u),m.is("input:radio")||m.is("input:checkbox"))for(l=
0;l<m.length;l++)c=a(m[l]),c[r]("checked",c.val()===String(e[h]));else m.val(la(e[h])?"":e[h])}})},FormToGrid:function(k,u,h,m){return this.each(function(){if(this.grid){h||(h="set");m||(m="first");var l=a(u).serializeArray(),c={};a.each(l,function(a,h){c[h.name]=h.value});"add"===h?G.addRowData.call(a(this),k,c,m):"set"===h&&G.setRowData.call(a(this),k,c)}})}})});
/*
//# sourceMappingURL=grid.formedit.map
*/