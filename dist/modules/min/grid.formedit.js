!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.common","./grid.filter"],function(a){return t(a,e,e.document)}):"object"==typeof module&&module.exports?module.exports=function(e,a){return e||(e=window),void 0===a&&(a="undefined"!=typeof window?require("jquery"):require("jquery")(e)),require("./grid.base"),require("./jquery.fmatter"),require("./grid.common"),require("./grid.filter"),t(a,e,e.document),a}:t(jQuery,e,e.document)}("undefined"!=typeof window?window:this,function(e,t,a){"use strict";var i=e.jgrid,o=i.jqID,r=e.fn.jqGrid,l=r.getGuiStyles,n=i.mergeCssClasses,d=i.hasOneFromClasses,s=i.feedback,c=i.fullBoolFeedback,u=i.builderFmButon,p=function(e,t,a){var i;!0===t[0]&&(i="<span class='"+n("fm-button-icon",a,t[2])+"'></span>","right"===t[1]?e.addClass("fm-button-icon-right").append(i):e.addClass("fm-button-icon-left").prepend(i))},h=function(e){return l.call(this,"states."+e)},f=function(t){t.find("tr[data-rowpos]").each(function(){var t=0;e(this).children("td").each(function(){"hidden"!==e(this).css("visibility")&&t++}),t||e(this).hide()})},m=function(e){return"&nbsp;"===e||"&#160;"===e||1===e.length&&160===e.charCodeAt(0)};i.extend({searchGrid:function(t){return this.each(function(){function a(t){k("beforeShow",t)&&(e(y).data("onClose",m.onClose),i.viewModal.call(d,y,{gbox:w,jqm:m.jqModal,overlay:m.overlay,modal:m.modal,overlayClass:m.overlayClass,toTop:m.toTop,onHide:function(e){e.w.remove(),e.o&&e.o.remove()}}),k("afterShow",t))}var d=this,p=e(d),f=d.p;if(d.grid&&null!=f){var m=e.extend(!0,{drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:f.prmNames.filters,loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,removemodal:!0,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,onReset:null,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE",in:"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"IS NOT NULL"}},r.getGridRes.call(p,"search"),i.search||{},f.searching||{},t||{}),v="fbox_"+f.id,g=m.commonIconClass,b={themodal:"searchmod"+v,modalhead:"searchhd"+v,modalcontent:"searchcnt"+v,resizeAlso:v},y="#"+o(b.themodal),w=f.gBox,x=f.gView,D=e.each,C=f.postData[m.sFilter],k=function(){var t=e.makeArray(arguments);return t.unshift("Search"),t.unshift("Filter"),t.unshift(m),s.apply(d,t)},F=function(){i.hideModal(y,{gb:w,jqm:m.jqModal,onClose:m.onClose,removemodal:m.removemodal})};if("string"==typeof C&&(C=""!==e.trim(C)?e.parseJSON(C):void 0),e(y).remove(),void 0!==e(y)[0])a(e("#fbox_"+o(f.id)));else{var _=e("<div><div id='"+v+"' class='"+l.call(d,"dialog.body","searchFilter")+"' style='overflow:auto'></div></div>").insertBefore(x);"rtl"===f.direction&&_.attr("dir","rtl");var S,E,O="",j="",q=!1,T=-1,A=e.extend([],f.colModel),G=u.call(d,v+"_search",m.Find,n(g,m.findDialogIcon),"right"),I=u.call(d,v+"_reset",m.Reset,n(g,m.resetDialogIcon),"left");if(m.showQuery&&(O=u.call(d,v+"_query","Query",n(g,m.queryDialogIcon),"left")+"&#160;"),m.searchForAdditionalProperties&&D(f.additionalProperties,function(){var e="string"==typeof this?{name:this}:this;e.label||(e.label=e.name),e.isAddProp=!0,A.push(e)}),m.columns.length?(A=m.columns,T=0,S=A[0].index||A[0].name):D(A,function(e,t){if(t.label||(t.label=t.isAddProp?t.name:f.colNames[e]),!q){var a=void 0===t.search||t.search,i=!0===t.hidden;(t.searchoptions&&!0===t.searchoptions.searchhidden&&a||a&&!i)&&(q=!0,S=t.index||t.name,T=e)}}),!C&&S||!1===m.multipleSearch){var N="eq";T>=0&&A[T].searchoptions&&A[T].searchoptions.sopt?N=A[T].searchoptions.sopt[0]:m.sopt&&m.sopt.length&&(N=m.sopt[0]),C={groupOp:"AND",rules:[{field:S,op:N,data:""}]}}q=!1,m.tmplNames&&m.tmplNames.length&&(q=!0,j=m.tmplLabel,j+="<select class='ui-template'>",j+="<option value='default'>Default</option>",D(m.tmplNames,function(e,t){j+="<option value='"+e+"'>"+t+"</option>"}),j+="</select>"),E="<div class='"+l.call(d,"dialog.footer")+"'><table class='EditTable' style='border:0px none;margin-top:5px' id='"+v+"_2'><tbody><tr><td colspan='2'><hr class='"+l.call(d,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='EditButton EditButton-"+f.direction+"'  style='float:"+("rtl"===f.direction?"right":"left")+";'>"+I+j+"</td><td class='EditButton EditButton-"+f.direction+"'>"+O+G+"</td></tr></tbody></table></div>",v=o(v),m.gbox=w,m.height="auto",e(v="#"+v).jqFilter({columns:A,filter:m.loadDefaults?C:null,showQuery:m.showQuery,errorcheck:m.errorcheck,sopt:m.sopt,groupButton:m.multipleGroup,ruleButtons:m.multipleSearch,afterRedraw:m.afterRedraw,ops:m.odata,cops:f.customSortOperations,operands:m.operands,ajaxSelectOptions:f.ajaxSelectOptions,groupOps:m.groupOps,onChange:function(t,a){t.showQuery&&e(".query",a).text(a.toUserFriendlyString()),c.call(d,m.afterChange,"jqGridFilterAfterChange",e(v),m,t,a)},direction:f.direction,id:f.id}),_.append(E),q&&m.tmplFilters&&m.tmplFilters.length&&e(".ui-template",_).on("change",function(){var t=e(this).val();return"default"===t?e(v).jqFilter("addFilter",C):e(v).jqFilter("addFilter",m.tmplFilters[parseInt(t,10)]),!1}),!0===m.multipleGroup&&(m.multipleSearch=!0),k("onInitialize",e(v)),m.layer?i.createModal.call(d,b,_,m,x,e(w)[0],"#"+o(m.layer),{position:"relative"}):i.createModal.call(d,b,_,m,x,e(w)[0]),(m.searchOnEnter||m.closeOnEscape)&&e(y).keydown(function(t){var a=e(t.target);return!m.searchOnEnter||13!==t.which||a.hasClass("add-group")||a.hasClass("add-rule")||a.hasClass("delete-group")||a.hasClass("delete-rule")||a.hasClass("fm-button")&&a.is("[id$=_query]")?m.closeOnEscape&&27===t.which?(e("#"+o(b.modalhead)).find(".ui-jqdialog-titlebar-close").click(),!1):void 0:(e(v+"_search").click(),!1)}),O&&e(v+"_query").on("click",function(){return e(".queryresult",_).toggle(),!1}),void 0===m.stringResult&&(m.stringResult=m.multipleSearch),e(v+"_search").on("click",function(){var t,a={},i="",o=e(v),r=o.find(".input-elm");if(r.filter(":focus")&&(r=r.filter(":focus")),r.change(),t=o.jqFilter("filterData"),m.errorcheck&&(o[0].hideError(),m.showQuery||o.jqFilter("toSQLString"),o[0].p.error))return o[0].showError(),!1;if(m.stringResult||"local"===f.datatype){try{i=JSON.stringify(t)}catch(e){}"string"==typeof i&&(a[m.sFilter]=i,D([m.sField,m.sValue,m.sOper],function(){a[this]=""}))}else m.multipleSearch?(a[m.sFilter]=t,D([m.sField,m.sValue,m.sOper],function(){a[this]=""})):(a[m.sField]=t.rules[0].field,a[m.sValue]=t.rules[0].data,a[m.sOper]=t.rules[0].op,a[m.sFilter]="");return e.extend(f.postData,a),c.call(d,m.onSearch,"jqGridFilterSearch",f.filters)&&(f.search=!0,p.trigger("reloadGrid",[e.extend({page:1},m.reloadGridSearchOptions||{})])),m.closeAfterSearch&&F(),!1}),e(v+"_reset").on("click",function(){var t={},a=e(v);return f.search=!1,f.resetsearch=!0,!1===m.multipleSearch?t[m.sField]=t[m.sValue]=t[m.sOper]="":t[m.sFilter]="",a[0].resetFilter(),q&&e(".ui-template",_).val("default"),e.extend(f.postData,t),c.call(d,m.onReset,"jqGridFilterReset")&&p.trigger("reloadGrid",[e.extend({page:1},m.reloadGridResetOptions||{})]),m.closeAfterReset&&F(),!1}),a(e(v));var B=h.call(d,"hover");e(".fm-button:not(."+h.call(d,"disabled").split(" ").join(".")+")",_).hover(function(){e(this).addClass(B)},function(){e(this).removeClass(B)})}}})},editGridRow:function(t,a){return this.each(function(){function c(){return e(I+" > tbody > tr > td .FormElement").each(function(){var t,a,r,l,n,d=e(".customelement",this),s=this.name;if(d.length){if(s=d.attr("name"),void 0!==(a=z[s])&&(t=M[a],r=t.editoptions||{},e.isFunction(r.custom_value))){try{if(F[s]=r.custom_value.call(D,e("#"+o(s),I),"get"),void 0===F[s])throw"e1"}catch(e){"e1"===e?i.info_dialog.call(D,Q,"function 'custom_value' "+q.msg.novalue,q.bClose):i.info_dialog.call(D,Q,e.message,q.bClose)}return!0}}else switch(n=e(this)[0].type){case"checkbox":F[s]=e(this).is(":checked")?e(this).val():e(this).data("offval");break;case"select-one":F[s]=e("option:selected",this).val();break;case"select-multiple":F[s]=e(this).val(),F[s]=F[s]?F[s].join(","):"";var c=[];e("option:selected",this).each(function(t,a){c[t]=e(a).text()});break;case"date":F[s]=e(this).val(),3===String(F[s]).split("-").length&&void 0!==(a=z[s])&&(l=((t=M[a]).formatoptions||{}).newformat||O.call(C,"formatter.date.newformat"),F[s]=i.parseDate.call(C[0],"Y-m-d",F[s],l));break;default:void 0!==n&&e.inArray(n,q.skipPostTypes)<0&&(F[s]=e(this).val())}}),!0}function v(t,a){var l,n,d,s,c,u=0;(q.checkOnSubmit||q.checkOnUpdate)&&(q._savedData={},q._savedData[E+"_id"]=t);var p=k.colModel;if("_empty"===t)return e(p).each(function(){l=this.name,d=e.extend({},this.editoptions||{}),(n=e("#"+o(l),a))&&n.length&&null!==n[0]&&(s="","custom"===this.edittype&&e.isFunction(d.custom_value)?d.custom_value.call(D,n,"set",s):d.defaultValue?(s=e.isFunction(d.defaultValue)?d.defaultValue.call(D):d.defaultValue,"checkbox"===n[0].type?(c=s.toLowerCase()).search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==c?(n[0].checked=!0,n[0].defaultChecked=!0,n[0].value=s):(n[0].checked=!1,n[0].defaultChecked=!1):n.val(s)):"checkbox"===n[0].type?(n[0].checked=!1,n[0].defaultChecked=!1,s=e(n).data("offval")):n[0].type&&"select"===n[0].type.substr(0,6)?n[0].selectedIndex=0:n.val(s),(!0===q.checkOnSubmit||q.checkOnUpdate)&&(q._savedData[l]=s))}),void e("#id_g",a).val(t);var h=r.getInd.call(C,t,!0);h&&(e(h.cells).filter("td[role=gridcell]").each(function(r){var n;if("cb"!==(l=p[r].name)&&"subgrid"!==l&&"rn"!==l&&!0===p[r].editable){try{n=e.unformat.call(D,e(this),{rowId:t,colModel:p[r]},r)}catch(t){n="textarea"===p[r].edittype?e(this).text():e(this).html()}switch(k.autoEncodeOnEdit&&(n=i.oldDecodePostedData(n)),(!0===q.checkOnSubmit||q.checkOnUpdate)&&(q._savedData[l]=n),l="#"+o(l),p[r].edittype){case"password":case"text":case"button":case"image":case"textarea":m(n)&&(n=""),e(l,a).val(n);break;case"select":var d=n.split(",");d=e.map(d,function(t){return e.trim(t)}),e(l+" option",a).each(function(){var t,a=e(this),i=e.trim(a.val());if(p[r].editoptions.multiple||d[0]!==i?p[r].editoptions.multiple&&(t=e.inArray(i,d))>-1?(d.splice(t,1),this.selected=!0):this.selected=!1:(d.splice(0,1),this.selected=!0),0===d.length)return!1}),d.length>0&&e(l+" option",a).each(function(){var t,a=e(this),i=e.trim(a.text());if(p[r].editoptions.multiple||e.trim(n)!==i&&d[0]!==i?p[r].editoptions.multiple&&(t=e.inArray(i,d))>-1&&(d.splice(t,1),this.selected=!0):(d.splice(0,1),this.selected=!0),0===d.length)return!1});break;case"checkbox":n=String(n),n=p[r].editoptions&&p[r].editoptions.value?p[r].editoptions.value.split(":")[0]===n:(n=n.toLowerCase()).search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==n,e(l,a).prop({checked:n,defaultChecked:n});break;case"custom":try{if(!p[r].editoptions||!e.isFunction(p[r].editoptions.custom_value))throw"e1";p[r].editoptions.custom_value.call(D,e(l,a),"set",n)}catch(e){"e1"===e?i.info_dialog.call(D,Q,"function 'custom_value' "+q.msg.nodefined,q.bClose):i.info_dialog.call(D,Q,e.message,q.bClose)}}u++}}),u>0&&e("#id_g",I).val(t))}function g(){var a,o,l,n,d,s,c,u,p=[!0,"",""],h=p,f={},m=k.prmNames,g=r.getInd.call(C,t),b=!1===g?null:D.rows[g],y=C.triggerHandler("jqGridAddEditBeforeCheckValues",[F,e(T),S]);y&&"object"==typeof y&&(F=y),g=!1===g?-1:g,e.isFunction(q.beforeCheckValues)&&(y=q.beforeCheckValues.call(D,F,e(T),S))&&"object"==typeof y&&(F=y);for(l in F)if(F.hasOwnProperty(l)&&(u=k.iColByName[l],null!=(h=i.checkValues.call(D,F[l],l,void 0,void 0,{oldValue:"_empty"===t?null:r.getCell.call(C,t,u),newValue:F[l],cmName:l,rowid:t,cm:M[u],iCol:u,iRow:g,tr:b,td:null==b?null:b.cells[u],mode:"_empty"===t?"addForm":"editForm"}))&&!0!==h||(h=p),!1===h[0]))break;if(function(){var t=q.url||k.editurl;e.each(M,function(a,i){var o=i.name;F.hasOwnProperty(o)&&("date"!==i.formatter||null!=i.formatoptions&&!0===i.formatoptions.sendFormatted||(F[o]=e.unformat.date.call(D,F[o],i)),"clientArray"!==t&&i.editoptions&&!0===i.editoptions.NullIfEmpty&&""===F[o]&&(F[o]="null"))})}(),h[0]&&(void 0===(f=C.triggerHandler("jqGridAddEditClickSubmit",[q,F,S]))&&e.isFunction(q.onclickSubmit)&&(f=q.onclickSubmit.call(D,q,F,S)||{}),null!=(h=C.triggerHandler("jqGridAddEditBeforeSubmit",[F,e(T),S]))&&!0!==h||(h=p),h[0]&&e.isFunction(q.beforeSubmit)&&(null!=(h=q.beforeSubmit.call(D,F,e(T),S))&&!0!==h||(h=p))),h[0]&&!q.processing){if(q.processing=!0,e("#sData",N).addClass(J),s=q.url||k.editurl,o=m.oper,a="clientArray"===s&&!1!==k.keyName?k.keyName:m.id,F[o]="_empty"===e.trim(F[E+"_id"])?m.addoper:m.editoper,F[o]!==m.addoper?F[a]=F[E+"_id"]:void 0===F[a]&&(F[a]=F[E+"_id"]),delete F[E+"_id"],F=e.extend(F,q.editData,f),!0===k.treeGrid){if(F[o]===m.addoper){n=k.selrow;var w="adjacency"===k.treeGridModel?k.treeReader.parent_id_field:"parent_id";F[w]=n}for(d in k.treeReader)if(k.treeReader.hasOwnProperty(d)&&(c=k.treeReader[d],F.hasOwnProperty(c))){if(F[o]===m.addoper&&"parent_id_field"===d)continue;delete F[c]}}F[a]=i.stripPref(k.idPrefix,F[a]),k.autoEncodeOnEdit&&e.each(F,function(t,a){e.isFunction(a)||(F[t]=i.oldEncodePostedData(a))});var x=e.extend({url:e.isFunction(s)?s.call(D,F[a],S,F,q):s,type:e.isFunction(q.mtype)?q.mtype.call(D,S,q,F[a],F):q.mtype,data:i.serializeFeedback.call(D,e.isFunction(q.serializeEditData)?q.serializeEditData:k.serializeEditData,"jqGridAddEditSerializeEditData",F),complete:function(t,l){if(C.jqGrid("progressBar",{method:"hide",loadtype:q.saveui}),e("#sData",N).removeClass(J),F[a]=e("#id_g",I).val(),t.status>=300&&304!==t.status||0===t.status&&4===t.readyState?(h[0]=!1,h[1]=C.triggerHandler("jqGridAddEditErrorTextFormat",[t,S]),e.isFunction(q.errorTextFormat)?h[1]=q.errorTextFormat.call(D,t,S):h[1]=l+" Status: '"+t.statusText+"'. Error code: "+t.status):(null!=(h=C.triggerHandler("jqGridAddEditAfterSubmit",[t,F,S]))&&!0!==h||(h=p),h[0]&&e.isFunction(q.afterSubmit)&&(null!=(h=q.afterSubmit.call(D,t,F,S))&&!0!==h||(h=p))),!1===h[0])e("#FormError>td",I).html(h[1]),e("#FormError",I).show();else{k.autoEncodeOnEdit&&e.each(F,function(e,t){F[e]=i.oldDecodePostedData(t)});var d=[e.extend({},q.reloadGridOptions||{})];if(F[o]===m.addoper?(h[2]||(h[2]=i.randId()),null==F[a]||"_empty"===F[a]||F[o]===m.addoper?F[a]=h[2]:h[2]=F[a],q.reloadAfterSubmit?C.trigger("reloadGrid",d):!0===k.treeGrid?r.addChildNode.call(C,h[2],n,F):r.addRowData.call(C,h[2],F,q.addedrow),q.closeAfterAdd?(!0!==k.treeGrid&&j.call(C,h[2]),H()):q.clearAfterAdd&&v("_empty",T)):(q.reloadAfterSubmit?(C.trigger("reloadGrid",d),q.closeAfterEdit||setTimeout(function(){j.call(C,F[a])},1e3)):!0===k.treeGrid?r.setTreeRow.call(C,F[a],F):r.setRowData.call(C,F[a],F),q.closeAfterEdit&&H()),e.isFunction(q.afterComplete)){var s=t;setTimeout(function(){C.triggerHandler("jqGridAddEditAfterComplete",[s,F,e(T),S]),q.afterComplete.call(D,s,F,e(T),S),s=null},50)}if((q.checkOnSubmit||q.checkOnUpdate)&&(e(T).data("disabled",!1),"_empty"!==q._savedData[E+"_id"])){var c;for(c in q._savedData)q._savedData.hasOwnProperty(c)&&F[c]&&(q._savedData[c]=F[c])}}q.processing=!1;try{e(T).find("input,textarea,select,button,object,*[tabindex]").filter(":input:visible:not(:disabled)").first().focus()}catch(e){}}},i.ajaxOptions,q.ajaxEditOptions);if(x.url||q.useDataProxy||(e.isFunction(k.dataProxy)?q.useDataProxy=!0:(h[0]=!1,h[1]+=" "+i.errors.nourl)),h[0])if(C.jqGrid("progressBar",{method:"show",loadtype:q.saveui,htmlcontent:q.savetext}),q.useDataProxy){var _=k.dataProxy.call(D,x,"set_"+E);void 0===_&&(_=[!0,""]),!1===_[0]?(h[0]=!1,h[1]=_[1]||"Error deleting the selected row!"):(x.data.oper===m.addoper&&q.closeAfterAdd&&H(),x.data.oper===m.editoper&&q.closeAfterEdit&&H())}else"clientArray"===x.url?(q.reloadAfterSubmit=!1,F=x.data,x.complete({status:200,statusText:""},"")):e.ajax(x)}!1===h[0]&&(e("#FormError>td",I).html(h[1]),e("#FormError",I).show())}function b(e,t){var a,i=!1;for(a in e)if(e.hasOwnProperty(a)&&String(e[a])!==String(t[a])){i=!0;break}return i}function y(){var t=!0;return e("#FormError",I).hide(),q.checkOnUpdate&&(F={},c(),(_=b(F,q._savedData))&&(e(T).data("disabled",!0),e(".confirm",P).show(),t=!1)),t}function w(t,a){var i=a[1].length-1;0===t?e("#pData",N).addClass(X):void 0!==a[1][t-1]&&d(e("#"+o(a[1][t-1])),X)?e("#pData",N).addClass(X):e("#pData",N).removeClass(X),t===i?e("#nData",N).addClass(X):void 0!==a[1][t+1]&&d(e("#"+o(a[1][t+1])),X)?e("#nData",N).addClass(X):e("#nData",N).removeClass(X)}function x(){var t=r.getDataIDs.call(C),a=e("#id_g",I).val();return[e.inArray(a,t),t]}var D=this,C=e(D),k=D.p;if(D.grid&&null!=k&&t){var F,_,S,E=k.id,O=r.getGridRes,j=r.setSelection,q=e.extend(!0,{top:0,left:0,width:300,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:l.call(this,"overlay"),removemodal:!0,skipPostTypes:["image","file"],saveui:"enable",savetext:O.call(C,"defaults.savetext")||"Saving..."},O.call(C,"edit"),i.edit,k.formEditing||{},a||{}),T="FrmGrid_"+E,A=T,G="TblGrid_"+E,I="#"+o(G),N=I+"_2",B={themodal:"editmod"+E,modalhead:"edithd"+E,modalcontent:"editcnt"+E,resizeAlso:T},P="#"+o(B.themodal),R=k.gBox,M=k.colModel,z=k.iColByName,V=1,L=0,U=q.commonIconClass,H=function(){i.hideModal(P,{gb:R,jqm:q.jqModal,onClose:q.onClose,removemodal:q.removemodal})},Q=O.call(C,"errors.errcap"),K=function(){var t=e.makeArray(arguments);return t.unshift(""),t.unshift("AddEdit"),t.unshift(q),s.apply(D,t)},W=h.call(D,"hover"),X=h.call(D,"disabled"),Y=h.call(D,"select"),J=h.call(D,"active"),$=h.call(D,"error");e(P).remove(),T="#"+o(T),"new"===t?(t="_empty",S="add",q.caption=q.addCaption):(q.caption=q.editCaption,S="edit");var Z=!0;!q.checkOnUpdate||!0!==q.jqModal&&void 0!==q.jqModal||q.modal||(Z=!1);var ee=isNaN(q.dataheight)?q.dataheight:q.dataheight+"px",te=isNaN(q.datawidth)?q.datawidth:q.datawidth+"px",ae=e("<form name='FormPost' id='"+A+"' class='FormGrid' onSubmit='return false;' style='width:"+te+";overflow:auto;position:relative;height:"+ee+";'></form>").data("disabled",!1),ie=e("<table id='"+G+"' class='EditTable'><tbody></tbody></table>");e(M).each(function(){var e=this.formoptions;V=Math.max(V,e?e.colpos||0:0),L=Math.max(L,e?e.rowpos||0:0)}),e(ae).append(ie);var oe=e("<tr id='FormError' style='display:none'><td class='"+$+"' colspan='"+2*V+"'>&#160;</td></tr>");if(oe[0].rp=0,e(ie).append(oe),oe=e("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*V+"'>"+(q.topinfo||"&#160;")+"</td></tr>"),oe[0].rp=0,e(ie).append(oe),K("beforeInitData",ae,S)){!function(){var a=i.detectRowEditing.call(D,t);if(null!=a)if("inlineEditing"===a.mode)r.restoreRow.call(C,t);else{var o=a.savedRow,l=D.rows[o.id];r.restoreCell.call(C,o.id,o.ic),e(l.cells[o.ic]).removeClass("edit-cell "+Y),e(l).addClass(Y).attr({"aria-selected":"true",tabindex:"0"})}}();var re="rtl"===k.direction,le=re?"nData":"pData",ne=re?"pData":"nData";!function(t,a,n){var d,s=0,c=[],u=!1,p=e(a),h="";for(d=1;d<=n;d++)h+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";if("_empty"!==t&&(u=r.getInd.call(C,t)),e(M).each(function(a){var r,d,f,v,g,b=this,y=b.name,w=b.editable,x=!1,F=!1,_="_empty"===t?"addForm":"editForm";switch(e.isFunction(w)&&(w=w.call(D,{rowid:t,iCol:a,iRow:u,cmName:y,cm:b,mode:_})),d=!(b.editrules&&!0===b.editrules.edithidden||!0!==b.hidden&&"hidden"!==w),String(w).toLowerCase()){case"hidden":w=!0;break;case"disabled":w=!0,x=!0;break;case"readonly":w=!0,F=!0}if("cb"!==y&&"subgrid"!==y&&!0===w&&"rn"!==y){if(!1===u)v="";else{r=e(D.rows[u].cells[a]);try{v=e.unformat.call(D,r,{rowId:t,colModel:b},a)}catch(e){v=b.edittype&&"textarea"===b.edittype?r.text():r.html()}m(v)&&(v="")}var S=e.extend({},b.editoptions||{},{id:y,name:y,rowId:t,mode:_,cm:b,iCol:a}),E=e.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},b.formoptions||{}),O=parseInt(E.rowpos,10)||s+1,j=parseInt(2*(parseInt(E.colpos,10)||1),10);if("_empty"===t&&S.defaultValue&&(v=e.isFunction(S.defaultValue)?S.defaultValue.call(D):S.defaultValue),b.edittype||(b.edittype="text"),k.autoEncodeOnEdit&&(v=i.oldDecodePostedData(v)),g=i.createEl.call(D,b.edittype,S,v,!1,e.extend({},i.ajaxOptions,k.ajaxSelectOptions||{})),(q.checkOnSubmit||q.checkOnUpdate)&&(q._savedData[y]=v),e(g).addClass("FormElement"),e.inArray(b.edittype,["text","textarea","checkbox","password","select"])>-1&&e(g).addClass(l.call(D,"dialog.dataField")),f=p.find("tr[data-rowpos="+O+"]"),E.rowabove){var A=e("<tr><td class='contentinfo' colspan='"+2*n+"'>"+E.rowcontent+"</td></tr>");p.append(A),A[0].rp=O}0===f.length&&(f=e("<tr data-rowpos='"+O+"'></tr>").addClass("FormData").attr("id","tr_"+y),e(f).append(h),p.append(f),f[0].rp=O);var G=e("td:eq("+(j-2)+")",f[0]),I=e("td:eq("+(j-1)+")",f[0]);G.html(void 0===E.label?k.colNames[a]:E.label||"&#160;");var N=I[m(I.html())?"html":"append"](E.elmprefix);if(N.append(g).append(E.elmsuffix),"INPUT"===g.tagName.toUpperCase()&&b.createColumnIndex&&S.generateDatalist){var B=C.jqGrid("generateDatalistFromColumnIndex",b.name);null!=B&&B.length>0&&(e(g).attr("list","dl_"+g.id),N.append(B.attr("id","dl_"+g.id)))}x?(G.addClass(X),I.addClass(X),e(g).prop("readonly",!0),e(g).prop("disabled",!0)):F&&e(g).prop("readonly",!0),"custom"===b.edittype&&e.isFunction(S.custom_value)&&S.custom_value.call(D,e("#"+o(y),T),"set",v),i.bindEv.call(D,g,S),d&&G.add(I).css("visibility","hidden"),c[s]=a,s++}}),f(p),s>0){var v=e("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*n-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+E+"_id' value='"+t+"'/></td></tr>");v[0].rp=s+999,p.append(v),(q.checkOnSubmit||q.checkOnUpdate)&&(q._savedData[E+"_id"]=t)}}(t,ie,V);var de=u.call(D,le,"",n(U,q.prevIcon),"","left"),se=u.call(D,ne,"",n(U,q.nextIcon),"","right"),ce=u.call(D,"sData",q.bSubmit),ue=u.call(D,"cData",q.bCancel),pe="<div class='"+l.call(D,"dialog.footer")+"'><table class='EditTable' id='"+G+"_2'><tbody><tr><td colspan='2'><hr class='"+l.call(D,"dialog.hr")+"' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton navButton-"+k.direction+"'>"+(re?se+de:de+se)+"</td><td class='EditButton EditButton-"+k.direction+"'>"+ce+"&#160;"+ue+"</td></tr>";if(pe+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+(q.bottominfo||"&#160;")+"</td></tr>",pe+="</tbody></table></div>",L>0){var he=[];e.each(e(ie)[0].rows,function(e,t){he[e]=t}),he.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),e.each(he,function(t,a){e("tbody",ie).append(a)})}q.gbox=R;var fe=!1;!0===q.closeOnEscape&&(q.closeOnEscape=!1,fe=!0);var me=e("<div></div>").append(e("<div class='"+l.call(D,"dialog.body")+"'></div>").append(ae)).append(pe);if(i.createModal.call(D,B,me,q,k.gView,e(R)[0]),q.topinfo&&e(".tinfo",I).show(),q.bottominfo&&e(".binfo",N).show(),me=null,pe=null,e(P).keydown(function(t){var a,i,o=(t.target.tagName||"").toUpperCase();if(!0===e(T).data("disabled"))return!1;if(13===t.which&&"TEXTAREA"!==o){if(a=e(N).find(":focus"),i=a.attr("id"),a.length>0&&e.inArray(i,["pData","nData","cData"])>=0)return a.trigger("click"),!1;if(!0===q.savekey[0]&&13===q.savekey[1])return e("#sData",N).trigger("click"),!1}if(!0===q.savekey[0]&&t.which===q.savekey[1]&&"TEXTAREA"!==o)return e("#sData",N).trigger("click"),!1;if(27===t.which)return!!y()&&(fe&&H(),!1);if(!0===q.navkeys[0]){if("_empty"===e("#id_g",I).val())return!0;if(t.which===q.navkeys[1])return e("#pData",N).trigger("click"),!1;if(t.which===q.navkeys[2])return e("#nData",N).trigger("click"),!1}}),q.checkOnUpdate&&(e("a.ui-jqdialog-titlebar-close span",P).removeClass("jqmClose"),e("a.ui-jqdialog-titlebar-close",P).off("click").click(function(){return!!y()&&(H(),!1)})),p(e("#sData",N),q.saveicon,U),p(e("#cData",N),q.closeicon,U),q.checkOnSubmit||q.checkOnUpdate){ce=u.call(D,"sNew",q.bYes),se=u.call(D,"nNew",q.bNo),ue=u.call(D,"cNew",q.bExit);var ve=q.zIndex||999;ve++,e("<div class='"+q.overlayClass+" jqgrid-overlay confirm' style='z-index:"+ve+";display:none;'>&#160;</div><div class='"+l.call(D,"dialog.content","confirm ui-jqconfirm")+"' style='z-index:"+(ve+1)+"'>"+q.saveData+"<br/><br/>"+ce+se+ue+"</div>").insertAfter(T),e("#sNew",P).click(function(){return g(),e(T).data("disabled",!1),e(".confirm",P).hide(),!1}),e("#nNew",P).click(function(){return e(".confirm",P).hide(),e(T).data("disabled",!1),setTimeout(function(){e(T).find("input,textarea,select,button,object,*[tabindex]").filter(":input:visible:not(:disabled)").first().focus()},0),!1}),e("#cNew",P).click(function(){return e(".confirm",P).hide(),e(T).data("disabled",!1),H(),!1})}K("onInitializeForm",e(T),S),"_empty"!==t&&q.viewPagerButtons?e("#pData,#nData",N).show():e("#pData,#nData",N).hide(),K("beforeShowForm",e(T),S),e(P).data("onClose",q.onClose),i.viewModal.call(D,P,{gbox:R,jqm:q.jqModal,overlay:q.overlay,modal:q.modal,overlayClass:q.overlayClass,toTop:q.toTop,onHide:function(e){e.w.remove(),e.o&&e.o.remove()}}),Z||e("."+o(q.overlayClass)).click(function(){return!!y()&&(H(),!1)}),e(".fm-button",P).hover(function(){e(this).addClass(W)},function(){e(this).removeClass(W)}),e("#sData",N).click(function(){return F={},e("#FormError",I).hide(),c(),"_empty"===F[E+"_id"]?g():!0===q.checkOnSubmit&&(_=b(F,q._savedData))?(e(T).data("disabled",!0),e(".confirm",P).show()):g(),!1}),e("#cData",N).click(function(){return!!y()&&(H(),!1)}),e("#nData",N).click(function(){if(!y())return!1;e("#FormError",I).hide();var t=x();if(t[0]=parseInt(t[0],10),-1!==t[0]&&t[1][t[0]+1]){if(!K("onclickPgButtons","next",e(T),t[1][t[0]]))return!1;v(t[1][t[0]+1],T),j.call(C,t[1][t[0]+1]),K("afterclickPgButtons","next",e(T),t[1][t[0]+1]),w(t[0]+1,t)}return!1}),e("#pData",N).click(function(){if(!y())return!1;e("#FormError",I).hide();var t=x();if(-1!==t[0]&&t[1][t[0]-1]){if(!K("onclickPgButtons","prev",e(T),t[1][t[0]]))return!1;if(d(e("#"+o(t[1][t[0]-1])),X))return!1;v(t[1][t[0]-1],T),j.call(C,t[1][t[0]-1]),K("afterclickPgButtons","prev",e(T),t[1][t[0]-1]),w(t[0]-1,t)}return!1}),K("afterShowForm",e(T),S);var ge=x();w(ge[0],ge)}}})},viewGridRow:function(t,a){return this.each(function(){function c(){!0!==C.closeOnEscape&&!0!==C.navkeys[0]||setTimeout(function(){e("#cData").focus()},0)}function v(t){var a,l,n=0,d=r.getInd.call(w,t,!0);d&&(e("td",d).each(function(t){l=A[t],"cb"!==(a=l.name)&&"subgrid"!==a&&"rn"!==a&&(a=o("v_"+a),e("#"+a+" span",F).html(i.getDataFieldOfCell.call(y,d,t).html()),n++)}),n>0&&e("#id_g",F).val(t))}function g(t,a){var i=a[1].length-1;0===t?e("#pData",_).addClass(R):void 0!==a[1][t-1]&&d(e("#"+o(a[1][t-1])),R)?e("#pData",_).addClass(R):e("#pData",_).removeClass(R),t===i?e("#nData",_).addClass(R):void 0!==a[1][t+1]&&d(e("#"+o(a[1][t+1])),R)?e("#nData",_).addClass(R):e("#nData",_).removeClass(R)}function b(){var t=r.getDataIDs.call(w),a=e("#id_g",F).val();return[e.inArray(a,t),t]}var y=this,w=e(y),x=y.p;if(y.grid&&null!=x&&t){var D=x.id,C=e.extend(!0,{top:0,left:0,width:0,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,closeOnEscape:!1,labelswidth:"",navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,removemodal:!0},r.getGridRes.call(w,"view"),i.view||{},x.formViewing||{},a||{}),k="#ViewGrid_"+o(D),F="#ViewTbl_"+o(D),_=F+"_2",S="ViewGrid_"+D,E="ViewTbl_"+D,O=C.commonIconClass,j={themodal:"viewmod"+D,modalhead:"viewhd"+D,modalcontent:"viewcnt"+D,resizeAlso:S},q="#"+o(j.themodal),T=x.gBox,A=x.colModel,G=1,I=0,N=function(){var t=e.makeArray(arguments);return t.unshift(""),t.unshift("View"),t.unshift(C),s.apply(y,t)},B=function(){i.hideModal(q,{gb:T,jqm:C.jqModal,onClose:C.onClose,removemodal:C.removemodal})},P=h.call(y,"hover"),R=h.call(y,"disabled"),M=isNaN(C.dataheight)?C.dataheight:C.dataheight+"px",z=isNaN(C.datawidth)?C.datawidth:C.datawidth+"px",V=e("<div class='"+l.call(y,"dialog.body")+"'><form name='FormPost' id='"+S+"' class='FormGrid' style='width:"+z+";overflow:auto;position:relative;height:"+M+";'></form></div>"),L=V.children("form.FormGrid"),U=e("<table id='"+E+"' class='EditTable'><tbody></tbody></table>");if(e(q).remove(),e(A).each(function(){var e=this.formoptions;G=Math.max(G,e?e.colpos||0:0),I=Math.max(I,e?e.rowpos||0:0)}),L.append(U),N("beforeInitData",L)){!function(t,a,o){var n,d,s,c,u,p,h,v,g=0,b=[],D=r.getInd.call(w,t),k=l.call(y,"dialog.viewData"),F=e(a),_=l.call(y,"dialog.viewLabel"),S=String(C.labelswidth)+(!C.labelswidth||isNaN(C.labelswidth)?"":"px"),E="<td class='"+l.call(y,"dialog.viewCellLabel","CaptionTD form-view-label")+(S?"' style='width:"+S+";":"")+"'>&#160;</td><td class='"+l.call(y,"dialog.viewCellData","DataTD form-view-data")+"'>&#160;</td>",O="",j=["integer","number","currency"],q=0,T=0;for(u=0;u<o;u++)O+=E;if(e(A).each(function(){(d=(!this.editrules||!0!==this.editrules.edithidden)&&!0===this.hidden)||"right"!==this.align||(this.formatter&&-1!==e.inArray(this.formatter,j)?q=Math.max(q,parseInt(this.width,10)):T=Math.max(T,parseInt(this.width,10)))}),p=0!==q?q:0!==T?T:0,e(A).each(function(t){if(n=this.name,h=!1,d=(!this.editrules||!0!==this.editrules.edithidden)&&!0===this.hidden,v="boolean"!=typeof this.viewable||this.viewable,"cb"!==n&&"subgrid"!==n&&"rn"!==n&&v){c=!1===D?"":i.getDataFieldOfCell.call(y,y.rows[D],t).html(),h="right"===this.align&&0!==p;var a=e.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),r=parseInt(a.rowpos,10)||g+1,l=parseInt(2*(parseInt(a.colpos,10)||1),10);if(a.rowabove){var u=e("<tr><td class='contentinfo' colspan='"+2*o+"'>"+a.rowcontent+"</td></tr>");F.append(u),u[0].rp=r}0===(s=F.find("tr[data-rowpos="+r+"]")).length&&((s=e("<tr data-rowpos='"+r+"'></tr>").addClass("FormData").attr("id","trv_"+n)).append(O),F.append(s),s[0].rp=r);var f=void 0===a.label?x.colNames[t]:a.label,w=e("td:eq("+(l-1)+")",s[0]),C=e("td:eq("+(l-2)+")",s[0]);C.html("<label for='"+n+"'"+(_?" class='"+_+"'>":">")+(f||"&nbsp;")+"</label>"),w[m(w.html())?"html":"append"]("<span id='"+n+"'"+(k?" class='"+k+"'>":">")+(c||"&nbsp;")+"</span>").attr("id","v_"+n),h&&e("td:eq("+(l-1)+") span",s[0]).css({"text-align":"right",width:p+"px"}),d&&C.add(w).css("visibility","hidden"),b[g]=t,g++}}),f(F),g>0){var G=e("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*o-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+t+"'/></td></tr>");G[0].rp=g+99,F.append(G)}}(t,U,G);var H="rtl"===x.direction,Q=H?"nData":"pData",K=H?"pData":"nData",W=u.call(y,Q,"",n(O,C.prevIcon),"","left"),X=u.call(y,K,"",n(O,C.nextIcon),"","right"),Y=u.call(y,"cData",C.bClose);if(I>0){var J=[];e.each(e(U)[0].rows,function(e,t){J[e]=t}),J.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),e.each(J,function(t,a){e("tbody",U).append(a)})}C.gbox=T;var $=e("<div></div>").append(V).append("<div class='"+l.call(y,"dialog.footer")+"'><table border='0' class='EditTable' id='"+E+"_2'><tbody><tr id='Act_Buttons'><td class='navButton navButton-"+x.direction+"' width='"+(C.labelswidth||"auto")+"'>"+(H?X+W:W+X)+"</td><td class='EditButton EditButton-"+x.direction+"'>"+Y+"</td></tr></tbody></table></div>");i.createModal.call(y,j,$,C,x.gView,e(x.gView)[0]),C.viewPagerButtons||e("#pData, #nData",_).hide(),$=null,e(q).keydown(function(t){var a,i;if(!0===e(k).data("disabled"))return!1;if(13===t.which&&(a=e(_).find(":focus"),i=a.attr("id"),a.length>0&&e.inArray(i,["pData","nData","cData"])>=0))return a.trigger("click"),!1;if(27===t.which)return C.closeOnEscape&&B(),!1;if(!0===C.navkeys[0]){if(t.which===C.navkeys[1])return e("#pData",_).trigger("click"),!1;if(t.which===C.navkeys[2])return e("#nData",_).trigger("click"),!1}}),p(e("#cData",_),C.closeicon,O),N("beforeShowForm",e(k)),i.viewModal.call(y,q,{gbox:T,jqm:C.jqModal,overlay:C.overlay,toTop:C.toTop,modal:C.modal,onHide:function(e){e.w.remove(),e.o&&e.o.remove()}}),e(".fm-button:not(."+R.split(" ").join(".")+")",_).hover(function(){e(this).addClass(P)},function(){e(this).removeClass(P)}),c(),e("#cData",_).click(function(){return B(),!1}),e("#nData",_).click(function(){e("#FormError",F).hide();var t=b();if(t[0]=parseInt(t[0],10),-1!==t[0]&&t[1][t[0]+1]){if(!N("onclickPgButtons","next",e(k),t[1][t[0]]))return!1;v(t[1][t[0]+1]),r.setSelection.call(w,t[1][t[0]+1]),N("afterclickPgButtons","next",e(k),t[1][t[0]+1]),g(t[0]+1,t)}return c(),!1}),e("#pData",_).click(function(){e("#FormError",F).hide();var t=b();if(-1!==t[0]&&t[1][t[0]-1]){if(!N("onclickPgButtons","prev",e(k),t[1][t[0]]))return!1;v(t[1][t[0]-1]),r.setSelection.call(w,t[1][t[0]-1]),N("afterclickPgButtons","prev",e(k),t[1][t[0]-1]),g(t[0]-1,t)}return c(),!1});var Z=b();g(Z[0],Z)}}})},delGridRow:function(t,a){return this.each(function(){var n=this,d=n.p,c=e(n);if(n.grid&&null!=d&&t){var f,m,v,g,b=d.id,y=e.extend(!0,{top:0,left:0,width:240,removemodal:!0,height:"auto",dataheight:"auto",datawidth:"auto",drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,closeOnEscape:!1,delData:{},idSeparator:",",onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1,delui:"disable",deltext:r.getGridRes.call(c,"defaults.deltext")||"Deleting..."},r.getGridRes.call(c,"del"),i.del||{},d.formDeleting||{},a||{}),w="DelTbl_"+b,x="#DelTbl_"+o(b),D={themodal:"delmod"+b,modalhead:"delhd"+b,modalcontent:"delcnt"+b,resizeAlso:w},C="#"+o(D.themodal),k=d.gBox,F=y.commonIconClass,_=function(){var t=e.makeArray(arguments);return t.unshift(""),t.unshift("Delete"),t.unshift(y),s.apply(n,t)},S=h.call(n,"hover"),E=h.call(n,"active"),O=h.call(n,"error");if(e.isArray(t)||(t=[String(t)]),void 0!==e(C)[0]){if(!_("beforeInitData",e(x)))return;e("#DelData>td",x).text(t.join(y.idSeparator)).data("rowids",t),e("#DelError",x).hide(),!0===y.processing&&(y.processing=!1,e("#dData",x).removeClass(E)),_("beforeShowForm",e(x)),i.viewModal.call(n,C,{gbox:k,jqm:y.jqModal,jqM:!1,overlay:y.overlay,toTop:y.toTop,modal:y.modal}),_("afterShowForm",e(x))}else{var j=isNaN(y.dataheight)?y.dataheight:y.dataheight+"px",q=isNaN(y.datawidth)?y.datawidth:y.datawidth+"px",T="<div class='"+l.call(n,"dialog.body")+"'><div id='"+w+"' class='formdata' style='width:"+q+";overflow:auto;position:relative;height:"+j+";'>";T+="<table class='DelTable'><tbody>",T+="<tr id='DelError' style='display:none'><td class='"+O+"'></td></tr>",T+="<tr id='DelData' style='display:none'><td >"+t.join(y.idSeparator)+"</td></tr>",T+="<tr><td class='delmsg'>"+y.msg+"</td></tr>",T+="</tbody></table></div></div>";var A=u.call(n,"dData",y.bSubmit),G=u.call(n,"eData",y.bCancel);if(T+="<div class='"+l.call(n,"dialog.footer")+"'><table class='EditTable' id='"+w+"_2'><tbody><tr><td><hr class='"+l.call(n,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton EditButton-"+d.direction+"'>"+A+"&#160;"+G+"</td></tr></tbody></table></div>",y.gbox=k,i.createModal.call(n,D,T,y,d.gView,e(d.gView)[0]),e("#DelData>td",x).data("rowids",t),!_("beforeInitData",e(T)))return;e(".fm-button",x+"_2").hover(function(){e(this).addClass(S)},function(){e(this).removeClass(S)}),p(e("#dData",x+"_2"),y.delicon,F),p(e("#eData",x+"_2"),y.cancelicon,F),e("#dData",x+"_2").click(function(){var t,a=[!0,""],o=e("#DelData>td",x),l=o.text(),s=o.data("rowids"),u={};if(e.isFunction(y.onclickSubmit)&&(u=y.onclickSubmit.call(n,y,l,s)||{}),e.isFunction(y.beforeSubmit)&&(a=y.beforeSubmit.call(n,l,s)||a),a[0]&&!y.processing){if(y.processing=!0,v=d.prmNames,f=e.extend({},y.delData,u),g=v.oper,f[g]=v.deloper,m=v.id,!(l=s.slice()).length)return!1;for(t in l)l.hasOwnProperty(t)&&(l[t]=i.stripPref(d.idPrefix,l[t]));f[m]=l.join(y.idSeparator),e(this).addClass(E);var p=y.url||d.editurl,h=e.extend({url:e.isFunction(p)?p.call(n,f[m],f,y,s):p,type:y.mtype,data:e.isFunction(y.serializeDelData)?y.serializeDelData.call(n,f,s):f,complete:function(t,o){var u;if(c.jqGrid("progressBar",{method:"hide",loadtype:y.delui}),e("#dData",x+"_2").removeClass(E),t.status>=300&&304!==t.status||0===t.status&&4===t.readyState?(a[0]=!1,e.isFunction(y.errorTextFormat)?a[1]=y.errorTextFormat.call(n,t):a[1]=o+" Status: '"+t.statusText+"'. Error code: "+t.status):e.isFunction(y.afterSubmit)&&(a=y.afterSubmit.call(n,t,f,s)||[!0]),!1===a[0])e("#DelError>td",x).html(a[1]),e("#DelError",x).show();else{if("local"===d.datatype||!0===d.treeGrid||!y.reloadAfterSubmit)if(!0===d.treeGrid)try{r.delTreeNode.call(c,s[0])}catch(e){}else for(s=s.slice(),u=0;u<s.length;u++)r.delRowData.call(c,s[u]);y.reloadAfterSubmit&&c.trigger("reloadGrid",[e.extend({},y.reloadGridOptions||{})]),setTimeout(function(){_("afterComplete",t,l,e(x),s)},50)}y.processing=!1,a[0]&&i.hideModal(C,{gb:k,jqm:y.jqModal,onClose:y.onClose,removemodal:y.removemodal})}},i.ajaxOptions,y.ajaxDelOptions);if(h.url||y.useDataProxy||(e.isFunction(d.dataProxy)?y.useDataProxy=!0:(a[0]=!1,a[1]+=" "+i.errors.nourl)),a[0])if(c.jqGrid("progressBar",{method:"show",loadtype:y.delui,htmlcontent:y.deltext}),y.useDataProxy){var w=d.dataProxy.call(n,h,"del_"+b);void 0===w&&(w=[!0,""]),!1===w[0]?(a[0]=!1,a[1]=w[1]||"Error deleting the selected row!"):i.hideModal(C,{gb:k,jqm:y.jqModal,onClose:y.onClose,removemodal:y.removemodal})}else"clientArray"===h.url?(f=h.data,h.complete({status:200,statusText:""},"")):e.ajax(h)}return!1===a[0]&&(e("#DelError>td",x).html(a[1]),e("#DelError",x).show()),!1}),e("#eData",x+"_2").click(function(){return i.hideModal(C,{gb:k,jqm:y.jqModal,onClose:y.onClose,removemodal:y.removemodal}),!1}),_("beforeShowForm",e(x)),i.viewModal.call(n,C,{gbox:k,jqm:y.jqModal,overlay:y.overlay,toTop:y.toTop,modal:y.modal}),_("afterShowForm",e(x))}!0===y.closeOnEscape&&setTimeout(function(){e(".ui-jqdialog-titlebar-close","#"+o(D.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(s,c,u,p,f,m,v){return"object"==typeof s&&(v=m,m=f,f=p,p=u,u=c,c=s,s=void 0),p=p||{},u=u||{},v=v||{},f=f||{},m=m||{},this.each(function(){var g=this,b=g.p,y=e(g);if(g.grid&&null!=b&&!(g.nav&&e(s).find(".navtable").length>0)){var w=b.id,x=e.extend({edit:!0,add:!0,del:!0,search:!0,refresh:!0,refreshstate:"firstpage",view:!1,closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,hideEmptyPagerParts:!0,alertwidth:200,alertheight:"auto",alerttop:null,removemodal:!0,alertleft:null,alertzIndex:null,iconsOverText:!1},r.getGridRes.call(y,"nav"),i.nav||{},b.navOptions||{},c||{});x.position=x.position||("rtl"===b.direction?"right":"left");var D,C,k,F=b.idSel,_=b.gBox,S=x.commonIconClass,E={themodal:"alertmod_"+w,modalhead:"alerthd_"+w,modalcontent:"alertcnt_"+w},O=function(){var r=a.documentElement,n=t,d=1024,s=768,c=y.closest(".ui-jqgrid").offset();void 0===e("#"+o(E.themodal))[0]&&(x.alerttop||x.alertleft||(void 0!==n.innerWidth?(d=n.innerWidth,s=n.innerHeight):null!=r&&void 0!==r.clientWidth&&0!==r.clientWidth&&(d=r.clientWidth,s=r.clientHeight),d=d/2-parseInt(x.alertwidth,10)/2-c.left+(void 0!==n.pageXOffset?n.pageXOffset:(r||a.body.parentNode||a.body).scrollLeft),s=s/2-25-c.top+(void 0!==n.pageYOffset?n.pageYOffset:(r||a.body.parentNode||a.body).scrollTop)),i.createModal.call(g,E,"<div class='"+l.call(g,"dialog.body")+"'><div>"+x.alerttext+"</div></div>",{gbox:_,jqModal:x.jqModal,drag:!0,resize:!0,caption:x.alertcap,top:null!=x.alerttop?x.alerttop:s,left:null!=x.alertleft?x.alertleft:d,width:x.alertwidth,height:x.alertheight,closeOnEscape:x.closeOnEscape,zIndex:x.alertzIndex,removemodal:x.removemodal},b.gView,e(_)[0],!1)),i.viewModal.call(g,"#"+o(E.themodal),{gbox:_,toTop:x.alertToTop,jqm:x.jqModal});var u=e("#"+o(E.modalhead)).find(".ui-jqdialog-titlebar-close");u.attr({tabindex:"0",href:"#",role:"button"}),setTimeout(function(){u.focus()},50)},j=function(t){var a;if(13===t.which&&(a=e(this).find(".ui-pg-button").filter(":focus")).length>0){var i=a[0].id,o=i.substr(0,e(this).closest(".ui-jqgrid-toppager").length>0?i.length-w.length-5:i.length-w.length-1)+"mod"+b.id,r=e(".ui-jqdialog").filter(":visible").map(function(){return this.id});if(e.inArray(o,r)<0)return a.trigger("click"),!1}},q=h.call(g,"hover"),T=h.call(g,"disabled"),A=l.call(g,"navButton","ui-pg-button");if(g.grid){g.modalAlert=O,void 0===s&&(b.pager?(s=b.pager,b.toppager&&(x.cloneToTop=!0)):b.toppager&&(s=b.toppager));var G,I,N,B,P,R,M,z=1,V=["left","center","right"],L="<div class='"+l.call(g,"navButton","ui-pg-button "+h.call(g,"disabled"))+"'><span class='ui-separator'></span></div>",U=function(){d(this,T)||e(this).addClass(q)},H=function(){e(this).removeClass(q)},Q=function(){return d(this,T)||(e.isFunction(x.addfunc)?x.addfunc.call(g,p):r.editGridRow.call(y,"new",p)),!1},K=function(t,a,i){if(!d(this,T)){var o=b.selrow;o?e.isFunction(t)?t.call(g,o,i):r[a].call(y,o,i):O()}return!1},W=function(){return K.call(this,x.editfunc,"editGridRow",u)},X=function(){return K.call(this,x.viewfunc,"viewGridRow",v)},Y=function(){var t;return d(this,T)||(b.multiselect?0===(t=b.selarrrow).length&&(t=null):t=b.selrow,t?e.isFunction(x.delfunc)?x.delfunc.call(g,t,f):r.delGridRow.call(y,t,f):O()),!1},J=function(){return d(this,T)||(e.isFunction(x.searchfunc)?x.searchfunc.call(g,m):r.searchGrid.call(y,m)),!1},$=function(){if(!d(this,T)){e.isFunction(x.beforeRefresh)&&x.beforeRefresh.call(g),b.search=!1,b.resetsearch=!0;try{if("currentfilter"!==x.refreshstate){b.postData.filters="";try{e("#fbox_"+F).jqFilter("resetFilter")}catch(e){}e.isFunction(g.clearToolbar)&&g.clearToolbar(!1)}}catch(e){}switch(x.refreshstate){case"firstpage":y.trigger("reloadGrid",[e.extend({},x.reloadGridOptions||{},{page:1})]);break;case"current":case"currentfilter":y.trigger("reloadGrid",[e.extend({},x.reloadGridOptions||{},{current:!0})])}e.isFunction(x.afterRefresh)&&x.afterRefresh.call(g)}return!1},Z=function(t,a,i){var o=e("<div class='"+A+"' tabindex='0' role='button'></div>"),r=x[t+"icon"],l=e.trim(x[t+"text"]);return o.append("<div class='ui-pg-div'><span class='"+(x.iconsOverText?n("ui-pg-button-icon-over-text",S,r):n(S,r))+"'></span>"+(l?"<span class='ui-pg-button-text"+(x.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+l+"</span>":"")+"</div>"),e(k).append(o),o.attr({title:x[t+"title"]||"",id:a||t+"_"+B}).click(i).hover(U,H),o};for(x.cloneToTop&&b.toppager&&(z=2),G=0;G<z;G++){if(k=e("<div class='ui-pg-table navtable' role='toolbar' style='float:"+("rtl"===b.direction?"right":"left")+";table-layout:auto;'></div>"),0===G?(B=w,(N=s)===b.toppager&&(B+="_top",z=1)):(N=b.toppager,B=w+"_top"),x.add&&Z("add",p.id,Q),x.edit&&Z("edit",u.id,W),x.view&&Z("view",v.id,X),x.del&&Z("del",f.id,Y),(x.add||x.edit||x.del||x.view)&&e(k).append(L),x.search&&(I=Z("search",m.id,J),m.showOnLoad&&!0===m.showOnLoad&&e(I,k).click()),x.refresh&&Z("refresh","",$),C=e(".ui-jqgrid>.ui-jqgrid-view").css("font-size")||"11px",e("body").append("<div id='testpg2' class='"+l.call(g,"gBox","ui-jqgrid")+"' style='font-size:"+C+";visibility:hidden;' ></div>"),D=e(k).clone().appendTo("#testpg2").width(),e("#testpg2").remove(),e(N+"_"+x.position,N).append(k),x.hideEmptyPagerParts)for(P=0;P<V.length;P++)V[P]!==x.position&&(0===(M=e(N+"_"+V[P],N)).length||0===M[0].childNodes.length?M.hide():1===M[0].childNodes.length&&(R=M[0].firstChild,!e(R).is("table.ui-pg-table")||0!==R.rows&&0!==R.rows[0].cells.length||M.hide()));b._nvtd&&(D>b._nvtd[0]&&(e(N+"_"+x.position,N).width(D),b._nvtd[0]=D),b._nvtd[1]=D),g.nav=!0,k.on("keydown.jqGrid",j)}y.triggerHandler("jqGridResetFrozenHeights")}}})},navButtonAdd:function(t,a){return"object"==typeof t&&(a=t,t=void 0),this.each(function(){var s=this,c=s.p;if(s.grid){var u=e.extend({caption:"newButton",title:"",onClickButton:null,position:"last",iconsOverText:!1},r.getGridRes.call(e(s),"nav"),i.nav||{},c.navOptions||{},a||{}),p=u.id,f=h.call(s,"hover"),m=h.call(s,"disabled"),v=l.call(s,"navButton","ui-pg-button");if(void 0===t)if(c.pager){if(r.navButtonAdd.call(e(s),c.pager,u),!c.toppager)return;t=c.toppager,p&&(p+="_top")}else c.toppager&&(t=c.toppager);"string"==typeof t&&0!==t.indexOf("#")&&(t="#"+o(t));var g=e(".navtable",t),b=u.commonIconClass;if(g.length>0){if(p&&g.find("#"+o(p)).length>0)return;var y=e("<div tabindex='0' role='button'></div>");"NONE"===u.buttonicon.toString().toUpperCase()?e(y).addClass(v).append("<div class='ui-pg-div'>"+(u.caption?"<span class='ui-pg-button-text"+(u.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+u.caption+"</span>":"")+"</div>"):e(y).addClass(v).append("<div class='ui-pg-div'><span class='"+(u.iconsOverText?n("ui-pg-button-icon-over-text",b,u.buttonicon):n(b,u.buttonicon))+"'></span>"+(u.caption?"<span class='ui-pg-button-text"+(u.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+u.caption+"</span>":"")+"</div>"),p&&e(y).attr("id",p),"first"===u.position&&g.children("div.ui-pg-button").length>0?g.children("div.ui-pg-button").first().before(y):g.append(y),e(y,g).attr("title",u.title||"").click(function(t){return d(this,m)||e.isFunction(u.onClickButton)&&u.onClickButton.call(s,u,t),!1}).hover(function(){d(this,m)||e(this).addClass(f)},function(){e(this).removeClass(f)}),e(s).triggerHandler("jqGridResetFrozenHeights")}}})},navSeparatorAdd:function(t,a){return a=e.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},a||{}),this.each(function(){if(this.grid){var i=this.p,n=l.call(this,"navButton","ui-pg-button "+h.call(this,"disabled"));if(void 0===t)if(i.pager){if(r.navSeparatorAdd.call(e(this),i.pager,a),!i.toppager)return;t=i.toppager}else i.toppager&&(t=i.toppager);"string"==typeof t&&0!==t.indexOf("#")&&(t="#"+o(t));var d=e(".navtable",t);if(d.length>0){var s="<div class='"+n+"'><span class='"+a.sepclass+"'></span>"+a.sepcontent+"</div>";"first"===a.position?0===d.children("div.ui-pg-button").length?d.append(s):d.children("div.ui-pg-button").first().before(s):d.append(s)}}})},GridToForm:function(t,a){return this.each(function(){var i,l,n,d;if(this.grid){var s=r.getRowData.call(e(this),t);if(s)for(i in s)if(s.hasOwnProperty(i))if((l=e("[name="+o(i)+"]",a)).is("input:radio")||l.is("input:checkbox"))for(n=0;n<l.length;n++)(d=e(l[n])).prop("checked",d.val()===String(s[i]));else l.val(m(s[i])?"":s[i])}})},FormToGrid:function(t,a,i,o){return this.each(function(){if(this.grid){i||(i="set"),o||(o="first");var l=e(a).serializeArray(),n={};e.each(l,function(e,t){n[t.name]=t.value}),"add"===i?r.addRowData.call(e(this),t,n,o):"set"===i&&r.setRowData.call(e(this),t,n)}})}})});
//# sourceMappingURL=grid.formedit.js.map